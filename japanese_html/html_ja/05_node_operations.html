<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="generator" content="Asciidoctor 2.0.16" />
<title>ライトニングネットワークノードの運用</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700" />
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="node_operations">ライトニングネットワークノードの運用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ここまで読んだら、おそらく Lightning ウォレットをセットアップしたことでしょう。この章では、さらに一歩進んで、完全なLightningノードをセットアップしていきます。セットアップだけでなく、その運用方法や長期的なメンテナンス方法についても学びます。</p>
</div>
<div class="paragraph">
<p>Lightningノードを独自に構築する理由は様々です。それらは以下の通りです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>単なるエンドユーザーではなく、ライトニングネットワークの完全かつ積極的な参加者であること。</p>
</li>
<li>
<p>eコマースストアを運営したり、ライトニング決済で収入を得たりする場合</p>
</li>
<li>
<p>ライトニングのルーティングフィー、またはチャネル流動性のレンタルによる収入を得ること。</p>
</li>
<li>
<p>ライトニング・ネットワークのための新しいサービス、アプリケーションまたはプラグインを開発するため。</p>
</li>
<li>
<p>Lightningの使用中にお客様のプライバシーを保護するために</p>
</li>
<li>
<p>Lightningを搭載したインスタントメッセージングアプリなど、Lightningの上に構築された一部のアプリを使用する場合</p>
</li>
<li>
<p>経済的自由、自立、そして主権のために</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>LNノードの運営にはコストがかかります。コンピュータ、インターネット常時接続、大容量のディスクスペース、そして多くの時間が必要です。
運用コストには電気代も含まれます。</p>
</div>
<div class="paragraph">
<p>しかし、この経験で身につくスキルは、他のさまざまな仕事にも応用できる貴重なものです。</p>
</div>
<div class="paragraph">
<p>さあ、はじめましょう</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">備考</div>
</td>
<td class="content">
<div class="paragraph">
<p>正確な事実に基づいて、ご自身の期待値を正しく設定することが重要です。
ルーティングフィーを得る<em>ことだけを</em>目的にライトニングノードを運用する場合は、まず下調べをしてください。
まずは真面目に下調べをしてください。ライトニングノードで収益を上げることは、決して簡単なことではありません。
簡単<em>では</em>ありません。初期費用と継続的な費用をすべてスプレッドシートで計算してください。LNの統計情報をよく調べてください。
現在の決済ボリュームは？ノードあたりのボリュームは？現在の平均的なルーティング手数料は？フォーラムを参照し
を参照し、実際の経験を積んだ他のコミュニティメンバーからのアドバイスやフィードバックを求めてください。このようなデューデリジェンスを行った上で、自分なりの意見を持つようにしましょう。
このデューデリジェンスを行った<em>後に</em>、自分の意見を決めてください。ほとんどの人は、ノードを運営する動機を金銭的な利益ではなく、他のところに見出すでしょう。
を見つけることができます。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_choosing_your_platform">プラットフォームの選択</h3>
<div class="paragraph">
<p>ライトニングノードを運用する方法には、自宅でホストする小型のミニPCや専用サーバー、クラウド上のホスティングサーバーなど、さまざまな方法があります。どの方法を選択するかは、持っているリソースと使いたい金額によって決まります。</p>
</div>
<div class="sect3">
<h4 id="continuous_operation">Lightningノードを運用する上で、なぜ信頼性が重要なのか？</h4>
<div class="paragraph">
<p>ビットコインでは、特にマイニングノードを実行する場合を除き、ハードウェアは特に重要ではありません。
ビットコインコアのノードソフトウェアは、その最小要件を満たす任意のマシン上で実行することができ、支払いを受け取るためにオンラインである必要はなく、それらを送信するだけでよい。
ビットコインのノードが長期間ダウンした場合、ユーザーはノードを再起動するだけで、ネットワークの残りの部分に接続すると、ブロックチェーンが再同期されます。</p>
</div>
<div class="paragraph">
<p>しかし、Lightningでは、ユーザーは支払の<em>送信と</em>受信の両方にオンラインである必要があります。Lightningノードがオフラインの場合、誰からも支払いを受け取ることができず、その結果、オープンインボイスを満たすことができません。
さらに、オフラインのノードのオープンチャネルは、支払いのルーティングに使用することができません。あなたのチャネルパートナーは、あなたがオフラインであることに気づき、支払いをルーティングするためにあなたに連絡することができません。あなたがあまりに頻繁にオフラインになる場合、チャネルパートナーはあなたのチャネルにロックされたビットコインを十分に活用されていないとみなし、そのチャネルを閉鎖する可能性があります。チャネルパートナーが先にコミットメントトランザクションを送信してあなたをだまそうとするプロトコル攻撃のケースはすでに説明しました。もしあなたがオフラインで、あなたのチャネルが監視されていない場合、盗みの試みは成功し、タイムロックが切れた後、あなたは何の救済も受けられなくなる可能性があります。
したがって、ライトニングノードにとって、ノードの信頼性は非常に重要です。</p>
</div>
<div class="paragraph">
<p>また、ハードウェアの故障やデータの消失の問題もある。ビットコインでは、ユーザーがニーモニックフレーズや秘密鍵のバックアップを持っていれば、ハードウェアの故障は些細な問題になります。ビットコインのウォレットとウォレット内のビットコインは、新しいパソコンで秘密鍵から簡単に復元することができる。ほとんどの情報はブロックチェーンから再ダウンロードすることができる。</p>
</div>
<div class="paragraph">
<p>一方、ライトニングでは、コミットメント・トランザクションや失効秘密など、ユーザーのチャンネルに関する情報は一般に知られておらず、個々のユーザーのハードウェアにのみ保存されます。
そのため、ライトニング・ネットワークにおけるソフトウェアやハードウェアの故障は、容易に資金の損失を招く可能性があります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_types_of_hardware_lightning_nodes">ハードウェアの種類 ライトニングノード</h4>
<div class="paragraph">
<p>ハードウェアのライトニングノードには、大きく分けて3つのタイプがあります。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">汎用コンピュータ</dt>
<dd>
<p>LNノードは、Windows、macOS、またはLinuxを実行するホームコンピュータまたはラップトップ上で実行することができます。一般的に、これはビットコインノードと一緒に実行されます。</p>
</dd>
<dt class="hdlist1">専用ハードウェア</dt>
<dd>
<p>ライトニングノードは、Raspberry Pi、Rock64、ミニPCなどの専用ハードウェアで実行することも可能です。このセットアップでは、通常、ビットコインノードやその他のアプリケーションを含むソフトウェアスタックを実行することになります。このセットアップは、ハードウェアがライトニングノードの実行と保守のみに特化されており、通常、インストール "ヘルパー" でセットアップされるため、人気があります。</p>
</dd>
<dt class="hdlist1">設定済みハードウェア</dt>
<dd>
<p>LNノードは、専用に選択され構成された専用ハードウェア上で動作させることもできる。これには、キットやターンキーシステムとして購入できる「すぐに使える」Lightningノードソリューションが含まれる。</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_running_in_the_cloud">"クラウド "で走る</h4>
<div class="paragraph">
<p>Microsoft Azure、Google Cloud、Amazon Web Services（AWS）、DigitalOceanなどの<em>仮想プライベートサーバ</em>（VPS）やクラウドコンピューティングサービスは非常に手頃で、非常に迅速にセットアップすることができます。このようなサービスでは、ライトニングノードを月額20ドルから40ドルでホスティングすることができます。</p>
</div>
<div class="paragraph">
<p>しかし、「"クラウド "は他人のコンピュータにすぎない」ということわざがあります。これらのサービスを利用するということは、他人のコンピュータで自分のノードを動かすということです。これには、相応のメリットとデメリットがあります。主なメリットは、利便性、効率性、アップタイム、そしておそらくコストです。クラウド事業者はノードを高度に管理・運営し、自動的に利便性と効率性を提供します。優れたアップタイムと可用性を提供し、多くの場合、個人が自宅で実現するよりもはるかに優れています。欧米の多くの国でサーバーを動かすのにかかる電気代が月10ドル程度であることを考えると、それにネットワークの帯域幅とハードウェア自体のコストを加えると、VPSの提供は金銭的に競争力のあるものになる。最後に、VPSを利用すれば、自宅にPCを置くスペースが不要で、PCの騒音や熱の問題もありません。
一方、デメリットもいくつかあります。クラウド」上で動作するライトニング・ノードは、自分のコンピュータ上で動作するものに比べて、常に安全性やプライバシーが損なわれます。さらに、これらのクラウドコンピューティングサービスは、非常に中央集権的です。このようなサービス上で動作するビットコインとライトニングノードの大部分は、バージニア、サニーベール、シアトル、ロンドン、フランクフルトの一握りのデータセンターに配置されています。これらのプロバイダーのネットワークやデータセンターにサービス上の問題が発生すると、いわゆる「分散型」ネットワーク上の数千のノードに影響を及ぼします。</p>
</div>
<div class="paragraph">
<p>自宅やオフィスの自分のコンピュータでノードを実行する可能性と能力があるなら、クラウドで実行するよりもこちらの方が望ましいかもしれません。
クラウドで運用するよりも望ましいかもしれません。しかし、自分のサーバーを動かすのが難しい場合は、ぜひVPSでの運用をご検討ください。</p>
</div>
</div>
<div class="sect3">
<h4 id="_running_a_node_at_home">自宅でノードを動かす</h4>
<div class="paragraph">
<p>自宅やオフィスにそれなりの容量のインターネット接続があれば、そこでライトニングノードを動かすことができるのは確かです。ブロードバンド接続であれば、軽量ノードの実行には十分であり、高速接続であればビットコインのフルノードを実行することも可能です。</p>
</div>
<div class="paragraph">
<p>ノートパソコンでライトニングノード（およびビットコインノードも）を実行することはできますが、かなり早く迷惑になるでしょう。これらのプログラムはコンピュータのリソースを消費し、24時間365日稼働する必要があります。ブラウザやスプレッドシートなどのユーザーアプリケーションは、コンピュータのリソースをめぐってライトニングのバックグラウンドサービスと競合することになります。つまり、ブラウザやその他のデスクトップのワークロードが遅くなるのです。
また、ワープロソフトがラップトップをフリーズさせると、Lightningノードもダウンし、トランザクションを受信できなくなり、攻撃を受けやすくなる可能性があります。さらに、ノートPCの電源は絶対に切ってはいけません。
これらのことが重なり、理想的なセットアップとは言えません。日常的に使用する個人のデスクトップPCも同様です。</p>
</div>
<div class="paragraph">
<p>その代わりに、ほとんどのユーザーは、専用のコンピュータでノードを実行することを選択します。
幸いなことに、「サーバー」クラスのコンピュータは必要ありません。
Raspberry PiなどのシングルボードコンピュータやミニPC（通常、ホームシアターPCとして販売されています）上でLightningノードを動作させることができます。
ミニPCは、ホームオートメーションのハブやメディアサーバとして一般的に使用されているシンプルなコンピュータです。
PCやノートPCに比べ、比較的安価に入手できます。
ライトニングとビットコインノードのプラットフォームとしての専用デバイスの利点は、ルーターやテレビの後ろに隠れて、ホームネットワーク上で継続的に、静かに、目立たないように実行できることです。
この小さな箱が、実はグローバルな銀行システムの一部であることを誰も知らないでしょう</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">警告</div>
</td>
<td class="content">
<div class="paragraph">
<p>32ビットオペレーティングシステムおよび/または32ビットCPUでノードを操作することは推奨されません。ノードソフトウェアがリソースの問題に直面し、クラッシュして資金が失われる可能性があるためです。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_what_hardware_is_required_to_run_a_lightning_node">Lightningノードを動作させるために必要なハードウェアは何ですか？</h4>
<div class="paragraph">
<p>Lightningノードを動作させるためには、最低限以下のものが必要です。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">CPU</dt>
<dd>
<p>ビットコインノードを動かすには十分な処理能力が必要であり、継続的に新しいブロックをダウンロードし、検証することになります。また、ユーザーは新しいビットコインノードを設定する際に、初期ブロックダウンロード（IBD）を考慮する必要があり、これは数時間から数日かかる可能性があります。2コアまたは4コアのCPUを推奨します。</p>
</dd>
<dt class="hdlist1">ラム</dt>
<dd>
<p>2GBのRAMを搭載したシステムでは、BitcoinとLightningの両方のノードを<em>かろうじて</em>動かすことができます。少なくとも4GBのRAMがあれば、はるかに良いパフォーマンスを発揮します。IBDは4GB以下のRAMでは特に難しいでしょう。署名検証などの暗号化操作により、この種のサービスではCPUがより大きなボトルネックとなるため、8GB以上のRAMは不要です。</p>
</dd>
<dt class="hdlist1">ストレージドライブ</dt>
<dd>
<p>これは、ハードディスクドライブ（HDD）またはソリッドステートドライブ（SSD）です。
ノードの実行にはSSDの方が圧倒的に速い（ただし高価）。
ストレージの大部分はビットコインのブロックチェーンに使用され、そのサイズは数百ギガバイトになります。
公正なトレードオフ（複雑さに対するコスト）は、OSを起動するために小さなSSDを購入し、大きなデータオブジェクト（主にデータベース）を保存するために大きなHDDを購入することです。</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">備考</div>
</td>
<td class="content">
<div class="paragraph">
<p>Raspberry Pisは、コストとパーツの入手性から、ノード・ソフトウェアを実行するための一般的な選択肢です。
このデバイス上で動作するOSは、通常、セキュアデジタル（SD）カードから起動します。
ほとんどのユースケースにおいて、これは問題ではありませんが、Bitcoin CoreはI/Oが重いことで有名です。
長期間の集中的なI/OはSDカードの故障の原因となるため、BitcoinブロックチェーンとLightningデータディレクトリを別のドライブに配置することを確認する必要があります。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">インターネット接続</dt>
<dd>
<p>新しいビットコインブロックをダウンロードしたり、他のライトニングピアと通信したりするためには、信頼できるインターネット接続が必要です。運用中の推定データ使用量は、設定により月10～100GBの範囲となります。起動時に、ビットコインフルノードがブロックチェーン全体をダウンロードします。</p>
</dd>
<dt class="hdlist1">電源</dt>
<dd>
<p>ライトニングノードは常にオンラインである必要があるため、信頼できる電力供給が必要です。停電が発生すると、進行中の決済が失敗してしまいます。負荷の大きいルーティングノードでは、停電時にバックアップまたは無停電電源装置（UPS）を使用すると便利です。
理想的には、インターネットルーターもこのUPSに接続することです。</p>
</dd>
<dt class="hdlist1">バックアップ</dt>
<dd>
<p>バックアップは非常に重要です。なぜなら、障害が発生すると、データの損失、ひいては資金の損失につながるからです。
何らかのデータバックアップソリューションを検討することをお勧めします。これは、あなたがコントロールするサーバーやウェブサービスへのクラウドベースの自動バックアップかもしれません。あるいは、2台目のハードディスクなど、ローカルのハードウェアを自動バックアップすることもできます。ローカルとリモートのバックアップを併用すると、より効果的です。</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_switching_server_configuration_in_the_cloud">クラウド上のサーバー構成を切り替える</h4>
<div class="paragraph">
<p>クラウドサーバーをレンタルする場合、2つの運用フェーズで構成を変更することが費用対効果につながることが多い。IBD（初日など）の間は、より高速なCPUと高速なストレージが必要になります。ブロックチェーンが同期した後は、CPUやストレージの速度要件が大幅に低下するため、より費用対効果の高いレベルに性能をダウングレードすることが可能です。</p>
</div>
<div class="paragraph">
<p>例えば、Amazonのクラウドでは、IBDに8-16GB RAM、8コアCPU（例：t3-largeまたはm3.large）、高速400GB SSD（1秒間に1000以上の入出力処理（IOPS）をプロビジョニング）を使い、その時間をわずか6-8時間に短縮することができます。それが完了したら、サーバーインスタンスを2GB RAM、2コアCPU（例：t3.small）に、ストレージを汎用の1TB HDDに変更することになります。この場合、ずっと遅いサーバーで実行した場合とほぼ同じコストがかかりますが、IBDのために1週間近く待たなければならない代わりに、1日もかからずに稼働させることができるのです。</p>
</div>
<div class="sect4">
<h5 id="_permanent_data_storage_drive">恒久的なデータ保存（ドライブ）</h5>
<div class="paragraph">
<p>ミニPCやレンタルサーバーを利用する場合、ストレージは最も高価な部分であり、コンピュータと接続性（データ）を足したのと同じだけのコストがかかることがあります。</p>
</div>
<div class="paragraph">
<p>では、どのような選択肢があるのか見ていきましょう。まず、ドライブには大きく分けて、HDDとSSDの2種類があります。HDDは安価で、SSDは高速ですが、どちらも仕事をします。</p>
</div>
<div class="paragraph">
<p>現在販売されている最速のSSDは、NVMe（Non-Volatile Memory Express）インターフェイスを採用しています。NVMe SSDはハイエンド機でより高速になりますが、コストも高くなります。
従来のSATAベースのSSDは安価ですが、それほど高速ではありません。SATA SSDは、お使いのノードのセットアップに十分な性能を発揮します。
小型のコンピュータでは、NVMe SSDを活用できない可能性があります。
例えば、Raspberry Pi 4は、USBポートの帯域幅が限られているため、その恩恵を受けることができません。</p>
</div>
<div class="paragraph">
<p>サイズを選ぶために、ビットコインのブロックチェーンを見てみましょう。2021年8月現在、そのサイズは取引インデックスを含めて360GBで、1年におよそ60GBずつ増えています。将来の成長やノードに他のデータをインストールするために、ある程度のマージンを確保したい場合は、少なくとも512GBのドライブ、より良い場合は1TBのドライブを購入しましょう。</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="helpers">インストーラーやヘルパーの使用</h3>
<div class="paragraph">
<p>ライトニングノードやビットコインノードのインストールは、コマンドライン環境に慣れていないと難しいかもしれません。幸いなことに、「ヘルパー」、つまり様々なコンポーネントをインストールし、設定してくれるソフトウェアを作るプロジェクトが数多く存在します。ノードと対話するために、コマンドラインの呪文を学ぶ必要はありますが、最初の作業のほとんどはあなたのために行われます。</p>
</div>
<div class="sect3">
<h4 id="_raspiblitz">ラズパイブリッツ</h4>
<div class="paragraph">
<p>最も人気があり、完全な「ヘルパー」の1つは、Christian Rotzollによって作られたプロジェクトである<em>RaspiBlitz</em><a href="#RaspiBlitz">(A RaspiBlitz node</a>)です。これは、Raspberry Pi 4にインストールすることを想定しています。RaspiBlitzには推奨ハードウェアキットが付属しており、数時間かせいぜい週末に組み立てることができます。あなたの街で開催されるライトニング「ハッカソン」に参加すれば、多くの人がRaspiBlitzのセットアップに取り組み、チップを交換し、お互いに助け合っている姿を目にすることができるでしょう。RaspiBlitzプロジェクトは、<a href="https://github.com/rootzoll/raspiblitz">GitHubで</a>ご覧いただけます。</p>
</div>
<div class="paragraph">
<p>ラズパイブリッツは、ビットコインとライトニングのノードに加え、以下のような追加サービスをインストールすることができます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tor (隠しサービスとして実行)</p>
</li>
<li>
<p>ElectRS (Rust版Electrumサーバー)</p>
</li>
<li>
<p>BTCPayサーバー（暗号通貨決済プロセッサー）</p>
</li>
<li>
<p>BTC RPC Explorer（ビットコイン・ブロックチェーン・エクスプローラー）</p>
</li>
<li>
<p>Ride The Lightning (ライトニングノード管理GUI)</p>
</li>
<li>
<p>LNbits（ライトニング・ウォレット／アカウント・システム）</p>
</li>
<li>
<p>Specter Desktop（マルチシグのTrezor、Ledger、Coldcardウォレット、Specter-DIY）</p>
</li>
<li>
<p>lndmanage (高度なチャネル管理用コマンドラインインターフェース)</p>
</li>
<li>
<p>ループ（サブマリン・スワップ・サービス）</p>
</li>
<li>
<p>JoinMarket（CoinJoinサービス）</p>
</li>
</ul>
</div>
<div id="RaspiBlitz" class="imageblock">
<div class="content">
<img src="images/mtln_0501.png" alt="mtln 0501" />
</div>
<div class="title">図1.RaspiBlitz ノード</div>
</div>
</div>
<div class="sect3">
<h4 id="_mynode">マイノード</h4>
<div class="paragraph">
<p><a href="https://mynodebtc.com"><em>myNodeは</em></a>、多くのビットコイン関連ソフトウェアを含む、もう一つの人気のあるオープンソース「ヘルパー」プロジェクトです。インストールは簡単で、インストーラーをSDカードに「フラッシュ」して、SDカードからミニPCを起動します。管理ツールはブラウザからリモートでアクセスできるため、myNodeを使用するためにモニターは必要ありません。ミニPCにモニター、マウス、キーボードがない場合でも、他のコンピュータやスマートフォンから管理することができます。インストールが完了したら、<a href="http://mynode.local" class="bare">http://mynode.local</a>、2クリックでLightningウォレットとノードを作成します。</p>
</div>
<div class="paragraph">
<p>myNodeは、ビットコインとライトニングのノードに加え、オプションで以下のような様々な追加サービスをインストールすることができます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ride The Lightning (ライトニングノード管理GUI)</p>
</li>
<li>
<p>OpenVPN（リモート管理またはウォレットのための仮想プライベートネットワーク[VPN]サポート）</p>
</li>
<li>
<p>lndmanage (高度なチャネル管理用コマンドラインインターフェース)</p>
</li>
<li>
<p>BTC RPC Explorer（ビットコイン・ブロックチェーン・エクスプローラー）</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_umbrel">アンブレル</h4>
<div class="paragraph">
<p>UX/UI（<a href="#umbrel">The Umbrel web interfaceで</a>示される）で有名な<em>Umbrelは</em>、特に初心者のために、ビットコインとライトニングノードをすぐに稼働させるための非常に簡単でアクセスしやすい方法を提供します。非常に特徴的なのは、UmbrelがIBD中にNeutrino/SPVを利用することで、即座にノードの利用を開始できることです。Bitcoin Coreがバックグラウンドで完全に同期されると、自動的に切り替わり、SPVモードが無効になります。Umbrel OSはRaspberry Pi 4をサポートしており、LinuxベースのOSやmacOS、Windowsの仮想マシンにもインストール可能です。また、Bitcoin Core P2P、Bitcoin Core RPC、Electrumプロトコル、またはlndconnectをサポートする任意のウォレットを接続することができます。</p>
</div>
<div class="paragraph">
<p>雨の日を待たなくても、すぐに<a href="https://getumbrel.com">Umbrelで</a>詳細を確認することができます。</p>
</div>
<div id="umbrel" class="imageblock">
<div class="content">
<img src="images/mtln_0502.png" alt="The Umbrel web interface" />
</div>
<div class="title">図2.UmbrelのWebインターフェース</div>
</div>
<div class="paragraph">
<p>Umbrelは、BitcoinとLightningのノードに加え、以下のような追加サービスを簡単にインストールできるUmbrel App Storeを導入しました。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lightning Terminal（チャンネルの流動性、Loop In、Loop Outを管理するためのインターフェイス）</p>
</li>
<li>
<p>Ride The Lightning (ライトニングノード管理GUI)</p>
</li>
<li>
<p>Specter Desktop（マルチシグネチャおよびシングルキービットコインウォレットのウォッチオンリーコーディネーター）</p>
</li>
<li>
<p>BTCPayサーバー（暗号通貨決済プロセッサー）</p>
</li>
<li>
<p>BTC RPC Explorer（ビットコイン・ブロックチェーン・エクスプローラー）</p>
</li>
<li>
<p>ThunderHub (ノードの監視と管理)</p>
</li>
<li>
<p>Sphinx Relay (Sphinxチャットの接続とストレージを扱う)</p>
</li>
<li>
<p>mempool.space (mempool ビジュアライザーおよびブロックエクスプローラー)</p>
</li>
<li>
<p>LNbits（ライトニング・ウォレット／アカウント・システム）</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Umbrelは現在まだベータ版であり、安全とは言えません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_btcpay_server">BTCPayサーバー</h4>
<div class="paragraph">
<p>当初はインストール「ヘルパー」として設計されたわけではありませんが、eコマースと決済プラットフォームの<em>BTCPay Serverは</em>、Dockerコンテナとdocker-composeを使って、Bitcoinノード、Lightningノード、決済ゲートウェイなど多くのサービスを驚くほど簡単にインストールできるシステムを備えています。シンプルなRaspberry Pi 4（4GB推奨）からミニPCや古いラップトップ、デスクトップ、サーバーまで、さまざまなハードウェアプラットフォームにインストールすることが可能です。</p>
</div>
<div class="paragraph">
<p><a href="https://btcpayserver.org">BTCPayサーバーは</a>、WordPress WooCommerceなどの多くのeコマースプラットフォームと統合することができる、フル機能のセルフホスティング、セルフカストディeコマースプラットフォームです。フルノードのインストールは、eコマースプラットフォームのインストールの一工程に過ぎません。
元々は<em>BitPay</em>商用決済サービスおよびAPIの機能代替品として開発されましたが、それを超えて、ECに関連するBTCおよびLightningサービスの完全なプラットフォームとして進化しています。多くのセラーやショップにとって、eコマースのワンショップターンキーソリューションとなっています。</p>
</div>
<div class="paragraph">
<p>BTCPay Serverは、ビットコインやライトニングのノードに加え、以下のような様々なサービスをインストールすることができます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>c-ライトニング</code>またはLND ライトニングノード</p>
</li>
<li>
<p>ライトコイン対応</p>
</li>
<li>
<p>Moneroのサポート</p>
</li>
<li>
<p>Sparkサーバー<code>（c-lightning</code>ウェブウォレット）</p>
</li>
<li>
<p>チャージサーバー<code>（c-lightning</code>ecommerce API）</p>
</li>
<li>
<p>Ride The Lightning (Lightningノード管理Web GUI)</p>
</li>
<li>
<p>多くのBTCフォーク</p>
</li>
<li>
<p>BTCTransmuter（為替をサポートするイベントアクションオートメーションサービス）</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>追加サービスや機能の数は急速に増加しているため、前述のリストはBTCPayサーバーのプラットフォームで利用可能なもののごく一部に過ぎません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_bitcoin_node_or_lightweight_lightning">Bitcoin NodeまたはLightweight Lightning</h4>
<div class="paragraph">
<p>セットアップのための重要な選択の1つは、ビットコインノードの選択とその構成です。リファレンス実装である<em>Bitcoin Coreは</em>最も一般的な選択肢ですが、利用可能な唯一の選択肢ではありません。<em>btcdは</em>、LNDライトニングノードを実行するために有用であり、Bitcoin Coreで利用できないいくつかの機能をサポートしています。</p>
</div>
<div class="paragraph">
<p>第二に、ブロックチェーンの完全なコピー（2021年半ばで約350GB）を持つ<em>アーカイブ</em>Bitcoinノードを実行するか、最新のブロックのみを保持する<em>プルーニングされた</em>ブロックチェーンを実行するかということを考慮する必要があります。刈り込まれたブロックチェーンはディスク容量を節約できますが、それでも少なくとも1回（IBDの間）ブロックチェーン全体をダウンロードする必要があります。したがって、ネットワークトラフィックを節約することはできません。Lightningノードを実行するために剪定されたノードを使用することは、まだ実験的な機能であり、すべての機能をサポートしていないかもしれません。しかし、多くの人がそのようなノードをうまく動かしています。</p>
</div>
<div class="paragraph">
<p>最後に、ビットコインノードを全く稼働させないという選択肢もあります。その代わり、LNDライトニングノードを「軽量」モードで運用し、ニュートリノ・プロトコルを使って、他の人が運用している公開ビットコインノードからブロックチェーン情報を取得することができる。このように実行することは、見返りを提供することなく、ビットコインネットワークからリソースを取ることを意味します。その代わり、リソースを提供し、LN コミュニティに貢献することになります。小規模なライトニングノードでは、一般に、完全なビットコインノードを実行する場合と比較して、ネットワークトラフィックが減少します。</p>
</div>
<div class="paragraph">
<p>ビットコインノードを運用することで、ライトニングノード以外にも、またライトニングノードの上でも、他のサービスをサポートすることができることに留意してください。これらの他のサービスは、アーカイブ（剪定されていない）Bitcoinノードを必要とする場合があり、Bitcoinノードなしでは実行できないことがよくあります。現在または将来的にどのようなサービスを実行したいかを前もって検討し、選択するBitcoinノードのタイプについて十分な情報を得た上で決定してください。</p>
</div>
<div class="paragraph">
<p>500GB以上のディスクを用意できるのであれば、フルアーカイブ・ビットコインノードを稼動させることです。あなたはビットコインシステムにリソースを貢献し、それをする余裕がない他の人を助けることになります。そのような大きなディスクを買う余裕がない場合は、剪定されたノードを走らせましょう。剪定されたノードのためのディスクや帯域幅に余裕がない場合は、Neutrino上で軽量のLNDノードを実行します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_operating_system_choice">オペレーティングシステムの選択</h4>
<div class="paragraph">
<p>次のステップは、ノードのオペレーティング・システムを選択することです。インターネット・サーバーの大部分は、Linuxの何らかのバージョンで動作しています。Linuxは強力なオープンソースのオペレーティングシステムであるため、インターネットに最適なプラットフォームです。しかし、Linuxは学習曲線が急で、コマンドライン環境に精通する必要があります。しかし、Linuxは学習曲線が急で、コマンドライン環境に精通する必要があり、新しいユーザーにとっては威圧的であることが多い。</p>
</div>
<div class="paragraph">
<p>最終的には、ほとんどのサービスは、macOS、Windows、そしてもちろんLinuxを含む最新のPOSIXオペレーティングシステム上で実行することができます。OSへの親しみやすさや快適さ、学習目的によって選ぶとよいでしょう。もしあなたが知識を増やし、Linuxシステムの操作方法を学びたいなら、これは特定のプロジェクトと明確な目標を持ってそれを行う絶好の機会です。ただ単にノードを立ち上げたいだけなら、自分の知っていることをやってみましょう。</p>
</div>
<div class="paragraph">
<p>最近では、多くのサービスもコンテナという形で提供されており、通常はDockerシステムをベースにしています。これらのコンテナは、基盤となるOSを抽象化して、様々なOS上にデプロイすることができます。しかし、ほとんどのコンテナでLinuxが動作しているため、LinuxのCLIコマンドを習得する必要があります。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_choose_your_lightning_node_implementation">Lightning Nodeの実装を選択する</h3>
<div class="paragraph">
<p>オペレーティング システムの選択と同様に、ライトニング ノードの実装の選択は、主にプロジェクトで使用されているプログラミング言語と開発ツールに精通しているかどうかに依存する必要があります。各ノード実装の間には若干の機能の違いがありますが、それは比較的小さなものであり、ほとんどの実装はBOLTによって定義された共通の標準に収束しています。</p>
</div>
<div class="paragraph">
<p>一方、プログラミング言語とビルドシステムに精通していることは、ノードを選択するための良い基礎となります。なぜなら、インストール、設定、継続的なメンテナンス、トラブルシューティングのすべてが、ビルドシステムで使われる様々なツールとのやりとりに関わるからです。これには</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>c-lightningの</code>ためのMake、Autotools、およびGNUユーティリティ</p>
</li>
<li>
<p>LNDのためのユーティリティを行く</p>
</li>
<li>
<p>Eclair用Java/Maven</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>プログラミング言語は、ビルドシステムの選択だけでなく、プログラムの他の多くの側面に影響を及ぼします。それぞれのプログラミング言語には全体の設計思想があり、次のような他の多くの側面に影響を与えます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>設定ファイルの形式と構文</p>
</li>
<li>
<p>ファイルの場所（ファイルシステム内）</p>
</li>
<li>
<p>コマンドライン引数とその構文</p>
</li>
<li>
<p>エラーメッセージのフォーマット</p>
</li>
<li>
<p>前提条件となるライブラリ</p>
</li>
<li>
<p>リモートプロシージャコールインターフェース</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Lightningノードを選ぶということは、前述したすべての特性を選ぶということでもあるのです。そのため、これらのツールや設計思想に精通していれば、ノードの運用が容易になります。あるいは、馴染みのない領域に着地した場合は、より難しくなります。</p>
</div>
<div class="paragraph">
<p>一方、コマンドラインやサーバー/サービス環境に初めて触れる場合、どのような実装にも馴染みがなく、全く新しいことを学ぶ機会に恵まれるでしょう。その場合は、次のような他の多くの要素に基づいて決定するとよいでしょう。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>サポートフォーラムやチャットルームの質</p>
</li>
<li>
<p>ドキュメントの品質</p>
</li>
<li>
<p>稼働させたい他のツールとの連携度合い</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>最終的な検討事項として、さまざまなノード実装の性能と信頼性を検証することができます。これは、このノードを本番環境で使用し、重いトラフィックと高い信頼性が要求されると予想される場合に特に重要です。例えば、ショップの決済システムをこのノードで実行する場合などがこれにあたります。</p>
</div>
</div>
<div class="sect2">
<h3 id="_installing_a_bitcoin_or_lightning_node">BitcoinまたはLightningノードのインストール</h3>
<div class="paragraph">
<p>インストール「ヘルパー」を使わず、Linux オペレーティングシステムのコマンド ラインに飛び込むことにしたのですか?それは勇敢な決断で、私たちはあなたがうまくいくように手助けをします。もし、手動でインストールしたくない場合は、<a href="#helpers">インストーラやヘルパーの使用</a>で説明するように、ノードソフトウェアのインストールを支援するアプリケーションや、コンテナベースのソリューションを使用することを検討してください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">警告</div>
</td>
<td class="content">
<div class="paragraph">
<p>このセクションでは、コマンドラインからのシステム管理という高度なトピックについて掘り下げます。Linuxの管理はそれ自体がスキルセットであり、本書の範囲外です。複雑なトピックであり、多くの落とし穴があります。慎重に進めてください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>次のセクションでは、Linux オペレーティングシステムに Bitcoin および Lightning ノードをインストールおよび設定する方法について簡単に説明します。使用することにした特定のBitcoinおよびLightningノードアプリケーションのインストール手順を確認する必要があります。通常、これらは<em>INSTALLと</em>呼ばれるファイル、または各プロジェクトの<em>docs</em>サブディレクトリで見つけることができます。私たちは、このようなすべてのサービスに適用される共通の手順の一部のみを説明し、私たちが提供する手順は必ずしも不完全なものになるでしょう。</p>
</div>
<div class="sect3">
<h4 id="_background_services">バックグラウンド・サービス</h4>
<div class="paragraph">
<p>デスクトップやスマートフォンでアプリケーションを実行することに慣れている人にとって、アプリケーションは時にバックグラウンドで実行されることがあっても、常にグラフィカルユーザーインターフェースを備えているものです。しかし、ビットコインとライトニングノードのアプリケーションは、全く異なります。これらのアプリケーションには、グラフィカルユーザーインターフェイスが組み込まれていません。つまり、常にバックグラウンドで動作し、ユーザーと直接対話することはありません<em>。</em></p>
</div>
<div class="paragraph">
<p>これは、バックグラウンドサービスの実行に慣れていないユーザーにとって、多少の混乱を引き起こす可能性があります。そのようなサービスが現在実行されているかどうかを知るにはどうすればよいのでしょうか？サービスの起動と停止はどのように行うのでしょうか？どのように操作するのでしょうか？これらの質問に対する答えは、使用しているオペレーティングシステムに依存します。ここでは、あなたがLinuxを使用していると仮定し、その文脈で回答します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_process_isolation">プロセスアイソレーション</h4>
<div class="paragraph">
<p>バックグラウンドサービスは通常、特定のユーザーアカウントで実行され、オペレーティングシステムや他のサービスから分離されます。たとえば、Bitcoin Coreはユーザーbitcoinとして実行されるように設定されています。コマンドラインを使用して、実行する各サービス用のユーザーを作成する必要があります。</p>
</div>
<div class="paragraph">
<p>さらに、外付けドライブを接続している場合は、ユーザーのホームディレクトリをそのドライブに再配置するよう、オペレーティングシステムに指示する必要があります。これは、Bitcoin Coreのようなサービスが、ユーザーのホームディレクトリの下にファイルを作成するためです。ビットコインのブロックチェーン全体をダウンロードするように設定している場合、これらのファイルは数百ギガバイトを占めることになります。ここでは、外付けドライブを接続し、それがオペレーティングシステムの<em>/external_drive/</em>パスに配置されていると仮定しています。</p>
</div>
<div class="paragraph">
<p>ほとんどのLinuxシステムでは、useraddコマンドを使って、次のように新しいユーザーを作成することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo useradd -m -d /external_drive/bitcoin -s /dev/null bitcoin</pre>
</div>
</div>
<div class="paragraph">
<p>mフラグとdフラグは、この例では<em>/external_drive/bitcoinで</em>指定されたユーザーのホームディレクトリを作成します。sフラグは、ユーザーの対話型シェルを指定します。今回は、対話型シェルを使用しないようにするため、<em>/dev/nullに</em>設定します。最後の引数は、新しいユーザーのユーザー名 bitcoin です。</p>
</div>
</div>
<div class="sect3">
<h4 id="_node_startup">ノードスタートアップ</h4>
<div class="paragraph">
<p>ビットコインとライトニングの両ノードサービスでは、「インストール」には、コンピュータの起動時にノードを確実に起動させるための、いわゆる<em>スタートアップスクリプトの</em>作成も含まれます。バックグラウンドサービスのスタートアップとシャットダウンは、Linuxではinitまたはsystemdと呼ばれるオペレーティングシステムプロセスによって処理されます。通常、システム起動スクリプトは各プロジェクトのcontribサブディレクトリに見つけることができます。例えば、systemd を使用する最新の Linux OS を使用している場合、Bitcoin Core ノードサービスを開始および停止できる<em>bitcoind.service</em>というスクリプトを見つけることができます。</p>
</div>
<div class="paragraph">
<p>Bitcoin Coreのコードリポジトリから引用した、Bitcoinノードのスタートアップスクリプトの例です。</p>
</div>
<div class="listingblock">
<div class="title">bitcoin/contrib/init/bitcoind.serviceより。</div>
<div class="content">
<pre>[ユニット]です。
Description=ビットコインデーモン
After=ネットワーク.ターゲット

[サービス］
ExecStart=/usr/bin/bitcoind -daemon \.
                            -pid=/run/bitcoind/bitcoind.pid ￤ -conf=/etc/bitcoin/bitcoin.pid
                            -conf=/etc/bitcoin/bitcoin.conf \.
                            -datadir=/var/lib/bitcoind

# config ディレクトリがサービスユーザから読めることを確認します。
PermissionsStartOnly=trueとする。
ExecStartPre=/bin/chgrp bitcoin /etc/bitcoin

# プロセス管理
####################

タイプ=forking
PIDFile=/run/bitcoind/bitcoind.pid
リスタート=オンフェイル
TimeoutStopSec=600

# ディレクトリの作成とパーミッション
####################################

# bitcoinとして実行:bitcoin
User=bitcoin
Group=bitcoin

# /run/bitcoind
RuntimeDirectory=bitcoind
ランタイムディレクトリモード=0710

# /etc/bitcoin
ConfigurationDirectory=bitcoin
コンフィギュレーションディレクトリモード=0710

# /var/lib/bitcoind
StateDirectory=bitcoind
ステートディレクトリモード=0710

[...]

[インストール］
WantedBy=multi-user.ターゲット</pre>
</div>
</div>
<div class="paragraph">
<p>root ユーザーで、スクリプトを systemd サービスフォルダ<em>/lib/systemd/system/</em>にコピーしてインストールし、systemd を再読み込みしてください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo systemctl daemon-reload</pre>
</div>
</div>
<div class="paragraph pagebreak-before">
<p>次に、サービスを有効にします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo systemctl enable bitcoind</pre>
</div>
</div>
<div class="paragraph">
<p>これでサービスの起動と停止ができるようになりました。まだBitcoinノードの設定をしていないので、起動しないようにしましょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo systemctl start bitcoind
sudo systemctl bitcoind を停止します。</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_node_configuration">ノード構成</h4>
<div class="paragraph">
<p>ノードを設定するためには、設定ファイルを作成し、参照する必要があります。慣習上、このファイルは通常<em>/etc</em> に、プログラム名と同じディレクトリの下に作成されます。例えば、Bitcoin CoreとLNDの設定は、通常、<em>/etc/bitcoin/bitcoin.confと</em>
<em>/etc/lnd/lnd.confに</em>それぞれ格納されます。</p>
</div>
<div class="paragraph">
<p>これらの設定ファイルはテキストファイルで、1行に1つの設定オプションとその値が表現されています。コンフィギュレーションファイルで定義されていないものについては、デフォルト値が想定されています。コンフィギュレーションで設定できるオプションは2つの方法で確認することができます。まず、nodeアプリケーションをhelp引数付きで実行すると、コマンドラインで定義可能なオプションが表示されます。これらの同じオプションはコンフィギュレーション・ファイルで定義することができます。2つ目は、通常、ソフトウェアのコードリポジトリで、全てのデフォルトオプションを含む設定ファイルのサンプルを見つけることができます。</p>
</div>
<div class="paragraph">
<p><a href="#set_up_a_lightning_node">set_up_a_lightning_node]</a> で使用した各Dockerイメージには、設定ファイルの例が1つずつあります。例えば、<em>code/docker/bitcoind/bitcoin.confという</em>ファイルです。</p>
</div>
<div class="listingblock">
<div class="title">docker bitcoindの設定ファイル(code/docker/bitcoind/bitcoin.conf)です。</div>
<div class="content">
<pre>regtest=1
server=1
デバッグログファイル=debug.log
デバッグ=1
txindex=1
printtoconsole=0

[レグテスト］
フォールバックフィー=0.000001
ポート=18444
noconnect=1
dnsseed=0
dns=0
upnp=0
onlynet=ipv4
rpcport=18443
rpcbind=0.0.0.0
rpcallowip=0.0.0.0/0
rpcuser=regtest（レグテスト
rpcpassword=regtest
zmqpubrawblock=tcp://0.0.0.0:12005
zmqpubrawtx=tcp://0.0.0.0:12006</pre>
</div>
</div>
<div class="paragraph">
<p>その特定の設定ファイルは、Bitcoin Coreをregtestノードとして動作するように設定し、リモートアクセス用の弱いユーザー名とパスワードを提供します。しかし、これは設定ファイルの構文を説明するためのものであり、Dockerコンテナ内でそれを調整し、異なるオプションを試すことができます。<a href="#set_up_a_lightning_node">set_up_a_lightning_node]</a> で構築した Docker ネットワークのコンテキストで、bitcoind -help コマンドを使用して、各オプションが何を行うかを理解できるかどうかを確認してください。</p>
</div>
<div class="paragraph">
<p>多くの場合、デフォルトで十分であり、いくつかの修正でノードソフトウェアを迅速に設定することができます。最小限のカスタマイズでBitcoin Coreノードを動作させるには、4行の設定が必要なだけです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server=1
デーモン=1
txindex=1
rpcuser=USERNAME（ユーザ名
rpcpassword=PASSWORD（パスワード</code></pre>
</div>
</div>
<div class="paragraph">
<p>txindex オプションも厳密には必要ではありませんが、Bitcoin ノードがすべてのトランザクションのインデックスを作成するようになり、一部のアプリケーションで必要とされます。txindexオプションは、ライトニングノードを実行するために必要ではありません。</p>
</div>
<div class="paragraph">
<p>同じサーバー上で動作する<code>c-lightning</code>Lightningノードも、設定は数行で済みます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ネットワーク=メインネット
bitcoin-rpcuser=USERNAME（ユーザー名
bitcoin-rpcpassword=PASSWORD（パスワード</code></pre>
</div>
</div>
<div class="paragraph">
<p>一般的に、これらのシステムのカスタマイズを最小限に抑えることが望ましいとされています。デフォルトの構成は、最も一般的なデプロイメントをサポートするように慎重に設計されています。デフォルトの値を変更すると、後で問題が発生したり、ノードのパフォーマンスが低下したりする可能性があります。要するに、必要なときだけ修正すればいいのです!</p>
</div>
</div>
<div class="sect3">
<h4 id="_network_configuration">ネットワーク構成</h4>
<div class="paragraph">
<p>通常、新しいアプリケーションを構成する際に、ネットワーク構成は問題になりません。しかし、ビットコインやライトニング・ネットワークのようなピアツーピア・ネットワークでは、ネットワーク・コンフィギュレーションにいくつかのユニークな課題が存在します。</p>
</div>
<div class="paragraph">
<p>集中型サービスでは、あなたのコンピューターはどこかの企業の「大きなサーバー」に接続し、その逆はない。自宅のインターネット接続は、実は、あなたが単に他の人が提供するサービスの消費者であるという前提で設定されています。しかし、ピアツーピア・システムでは、すべてのピアが他のノードからサービスを消費し、他のノードにサービスを提供します。自宅でビットコインやライトニングのノードを動かしている場合、インターネット上の他のコンピュータにサービスを提供していることになります。インターネットサービスのデフォルトでは、サーバーを実行できるように設定されていないため、他の人があなたのノードに到達できるようにするためには、いくつかの追加設定が必要な場合があります。</p>
</div>
<div class="paragraph">
<p>ビットコインまたはライトニングのノードを実行したい場合、インターネット上の他のノードがあなたに接続できるようにする必要があります。つまり、ビットコインポート（デフォルトではポート8333）またはライトニングポート（デフォルトではポート9735）への着信TCP接続を有効にすることです。ビットコインノードは着信接続なしで実行できますが、ライトニングノードではそのようなことはできません。ライトニングノードは、ネットワーク外からアクセス可能でなければなりません。</p>
</div>
<div class="paragraph">
<p>デフォルトでは、自宅のインターネットルーターは外部からの着信接続を期待しておらず、実際には着信接続はブロックされています。インターネットルーターのIPアドレスは、外部からアクセス可能な唯一のIPアドレスで、ホームネットワーク内で実行するすべてのコンピュータは、その単一のIPアドレスを共有しています。これは、<em>ネットワークアドレス変換</em><em>（NAT</em>）と呼ばれるメカニズムによって実現されており、インターネットルーターはすべてのアウトバウンド接続のための仲介者として機能することができます。インバウンド接続を許可したい場合は、<em>ポート転送を</em>設定する必要があります。これは、特定のポート上の着信接続は、ネットワーク内の特定のコンピュータに転送されるべきであることをインターネットルータに指示するものです。これは、インターネットルーターの設定を変更して手動で行うか、ルーターが対応している場合は、<em>ユニバーサルプラグアンドプレイ</em><em>（UPnP</em>）と呼ばれる自動ポート転送機構を使用して行うことができます。</p>
</div>
<div class="paragraph">
<p>ポートフォワーディングに代わる仕組みとして、オニオンルーター（Tor）を有効にすることがあります。これは、<em>オニオンアドレスへの</em>着信接続を可能にする仮想プライベートネットワークのオーバーレイの一種を提供します。Torを実行する場合、ポートフォワーディングを行ったり、ビットコインやライトニングのポートへの着信接続を有効にする必要はない。Torを使用してノードを実行する場合、すべてのトラフィックはTorを経由し、他のポートは使用されません。</p>
</div>
<div class="paragraph">
<p>ここでは、他の人があなたのノードに接続できるようにするための様々な方法について見てみましょう。簡単なものから難しいものへと順番に見ていきましょう。</p>
</div>
<div class="sect4">
<h5 id="_it_just_works">まさに「効く！」。</h5>
<div class="paragraph">
<p>インターネットサービスプロバイダやルーターがデフォルトでUPnPをサポートするように設定されており、すべてが自動的に動作する可能性があります。念のため、まずはこの方法を試してみましょう。</p>
</div>
<div class="paragraph">
<p>すでにビットコインやライトニングのノードが稼働していると仮定して、それらが外部からアクセス可能かどうかを試してみます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">備考</div>
</td>
<td class="content">
<div class="paragraph">
<p>このテストを行うには、ホームネットワーク上でBitcoinまたはLightningノード（またはその両方）を稼働させる必要があります。ルーターがUPnPをサポートしている場合、受信トラフィックは自動的にノードを実行しているコンピュータの対応するポートに転送されます。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>外部IPアドレスと、それが既知のポートへの着信接続を許可し転送しているかどうかを調べるには、いくつかの非常に有名で便利なウェブサイトを使用することができます。ここでは、信頼性の高い2つを紹介します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://canyouseeme.org" class="bare">https://canyouseeme.org</a></p>
</li>
<li>
<p><a href="https://www.whatismyip.com/port-scanner" class="bare">https://www.whatismyip.com/port-scanner</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>デフォルトでは、これらのサービスでは、接続元のIPアドレスへの着信接続のみを確認することができます。これは、このサービスを使用して他人のネットワークやコンピュータをスキャンすることを防ぐために行われます。ルーターの外部IPアドレスと、ポート番号を入力するフィールドが表示されます。ノードの設定でデフォルトのポートを変更していない場合は、ポート8333（Bitcoin）および／または9735（Lightning）を試してみてください。</p>
</div>
<div class="paragraph">
<p><a href="#ln_port_check">受信ポート9735の確認では</a>、<em>whatismyip.comの</em>ポートスキャナツールを使用して、Lightningが動作しているサーバーのポート9735を確認した結果を見ることができます。これは、サーバーが Lightning ポートへの着信接続を受け入れていることを示しています。このような結果が表示されれば、準備は完了です!</p>
</div>
<div id="ln_port_check" class="imageblock">
<div class="content">
<img src="images/mtln_0503.png" alt="mtln 0503" />
</div>
<div class="title">図3.9735番ポートの着信を確認する</div>
</div>
</div>
<div class="sect4">
<h5 id="_automatic_port_forwarding_using_upnp">UPnPによる自動ポートフォワーディング</h5>
<div class="paragraph">
<p>インターネットルーターがUPnPに対応していても、デフォルトでオフになっている場合があります。その場合は、インターネットルーターのWeb管理インターフェイスから設定を変更する必要があります。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>インターネットルーターの設定サイトに接続します。通常、ウェブブラウザーを使ってホームネットワークの<em>ゲートウェイアドレスに</em>接続することで可能です。ゲートウェイアドレスは、ホームネットワーク上の任意のコンピュータのIP設定を見ることによって見つけることができます。それは、192.168.0.1や10.0.0.1などの非ルータブルネットワークの1つの最初のアドレスであることが多いのです。<em>ゲートウェイの</em>アドレスのために同様にあなたのルータ上のすべてのシールを確認してください.見つかったら、ブラウザを開き、ブラウザのURL/検索ボックスにIPアドレスを入力します。例えば、"192.168.0.1" や "http://192.168.0.1." などです。</p>
</li>
<li>
<p>ルーターのウェブ設定パネルの管理者ユーザー名とパスワードを探します。これは、多くの場合、ルータ自体のステッカーに書かれており、 "admin "と "パスワード "と同じくらい簡単であるかもしれません。あなたのISPとルータのモデルのためのクイックウェブ検索はまた、この情報を見つけるのに役立ちます。</p>
</li>
<li>
<p>UPnPの設定を探し、ONにする。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ビットコインおよび/またはライトニングノードを再起動し、前のセクションで使用したウェブサイトの1つでポート開放テストを繰り返してください。</p>
</div>
</div>
<div class="sect4">
<h5 id="_using_tor_for_incoming_connections">受信接続にTorを使用する</h5>
<div class="paragraph">
<p><em>Onion Router</em><em>(Tor</em>) は、ホップ間の通信を暗号化し、仲介ノードがパケットの発信元や宛先を特定できないようにする特殊な特性を持つ VPN である。ビットコインとライトニングの両ノードはTor上での操作をサポートしており、IPアドレスや所在地を明らかにすることなくノードを操作することが可能です。したがって、ネットワークトラフィックに高いレベルのプライバシーを提供することができます。Torを運用することの付加的な利点は、VPNとして動作するため、インターネットルーターからのポートフォワーディングの問題を解決することです。着信接続はTorトンネル上で受信され、あなたのノードはIPアドレスの代わりにアドホックに生成された<em>オニオンアドレス</em>を通して見つけることができます。</p>
</div>
<div class="paragraph">
<p>Torを有効にするには2つのステップが必要です。まず、Torルーターとプロキシをコンピュータにインストールする必要があります。2つ目は、BitcoinやLightningの設定でTorプロキシの使用を有効にすることです。</p>
</div>
<div class="paragraph">
<p>aptパッケージマネージャを使用するUbuntu LinuxシステムにTorをインストールするには、以下を実行してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt install tor</pre>
</div>
</div>
<div class="paragraph">
<p>次に、Lightningノードが外部接続にTorを使用するように設定します。以下はLNDの設定例です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[トーア］
tor.active=trueを指定します。
tor.v3=trueとする。
tor.streamisolation=trueとする。
listen=localhost</pre>
</div>
</div>
<div class="paragraph">
<p>これはTorを有効にし(tor.active)、v3オニオンサービスを確立し(tor.v3=true)、各接続に異なるオニオンストリームを使用します(tor.streamisolation)。streamisolation)、そしてあなたのIPアドレスが漏れないようにローカルホストへの接続のみリスニングを制限します<code>(listen=localhost</code>)。</p>
</div>
<div class="paragraph">
<p>Torが正しくインストールされ動作しているかは、簡単な一行コマンドを実行することで確認できます。このコマンドはほとんどのLinuxのフレーバーで動作するはずです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl --socks5 localhost:9050 --socks5-hostname localhost:9050 -s https://check.torproject.org/ | cat | grep -m 1 おめでとうございます | xargs</pre>
</div>
</div>
<div class="paragraph">
<p>すべてが正しく動作している場合、このコマンドの応答は "Congratulations.このブラウザはTorを使用するように設定されています。"</p>
</div>
<div class="paragraph">
<p>Tor の性質上、外部サービスを使って自分のノードがオニオンアドレスで到達可能かどうかを簡単に確認することはできません。それでも、ライトニングノードのログにあなたのTor onionアドレスが表示されるはずです。それは文字と数字の長い文字列で、.onionという接尾辞が続きます。これであなたのノードはインターネットから到達可能になり、プライバシーの付加価値も得られます!</p>
</div>
</div>
<div class="sect4">
<h5 id="_manual_port_forwarding">手動ポートフォワーディング</h5>
<div class="paragraph">
<p>これは最も複雑なプロセスであり、かなりの技術的スキルが必要です。詳細は、お使いのインターネットルーターの種類、サービスプロバイダーの設定やポリシー、その他多くの状況によって異なります。このはるかに難しいメカニズムを試す前に、まずUPnPかTorを試してみてください。</p>
</div>
<div class="paragraph">
<p>基本的な手順は次のとおりです。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ノードのコンピュータのIPアドレスを探します。これは通常、DHCP（Dynamic Host Configuration Protocol）によって動的に割り当てられ、192.168.x.xまたは10.x.xの範囲のどこかであることがよくあります。</p>
</li>
<li>
<p>ノードのネットワークインターフェースのメディアアクセスコントロール（MAC）アドレスを探します。これは、そのコンピュータのインターネット設定で見つけることができます。</p>
</li>
<li>
<p>ノードに固定IPアドレスを割り当てて、常に同じIPアドレスになるようにします。現在持っているIPアドレスを使用することができます。インターネットルーターで、DHCP設定の下にある「Static Leases」を探します。MACアドレスを選択したIPアドレスにマッピングします。これで、あなたのノードには常にそのIPアドレスが割り当てられます。または、ルーターのDHCP設定を見て、そのDHCPアドレスの範囲が何であるかを調べることができます。DHCPアドレスの範囲<em>外の</em>未使用のアドレスを選択します。次に、サーバー上で、DHCPの使用を停止するようにネットワークを設定し、選択した非DHCP IPアドレスをオペレーティングシステムのネットワーク構成にハードコードします。</p>
</li>
<li>
<p>最後に、インターネットルーターで「ポートフォワーディング」を設定し、特定のポートから入ってくるトラフィックを、選択したサーバーのIPアドレスにルーティングするようにします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>再設定が完了したら、前のセクションで紹介したウェブサイトのいずれかを使用して、ポートのチェックを繰り返してください。</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_of_your_node">ノードのセキュリティ</h3>
<div class="paragraph">
<p>ライトニングノードは、定義上、<em>ホットウォレット</em>です。つまり、ライトニングノードが管理する資金（オンチェーンおよびオフチェーンの両方）は、ノードのメモリにロードされるか、ノードのハードディスクに保存されるキーによって直接管理されることになるのです。Lightningノードが侵害された場合、オンチェーンまたはオフチェーンのトランザクションを作成し、その資金を流出させることは些細なことです。そのため、不正なアクセスから保護することが非常に重要です。</p>
</div>
<div class="paragraph">
<p>セキュリティは全体的な取り組みであり、システムのすべてのレイヤーを保護する必要があることを意味します。諺にあるように、チェーンは最も弱いリンクによってのみ強くなるのです。これは情報セキュリティの重要な概念であり、私たちのノードにも適用していきます。</p>
</div>
<div class="paragraph">
<p>セキュリティ対策は万全ですが、ライトニング・ネットワークは初期段階の実験的技術であり、利用するプロジェクトのコードに悪用可能なバグが存在する可能性があることを忘れないでください。<em>ライトニング・ネットワークに、損失を覚悟している以上の資金を投入しないでください。</em></p>
</div>
<div class="sect3">
<h4 id="_operating_system_security">オペレーティングシステムのセキュリティ</h4>
<div class="paragraph">
<p>オペレーティングシステムの保護は、本書の範囲を超えた広大なテーマです。しかし、いくつかの基本原則を確立することはできます。</p>
</div>
<div class="paragraph">
<p>オペレーティング・システムのセキュリティを確保するために、上位の項目を紹介します。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">プロヴァンス</dt>
<dd>
<p>正しいオペレーティングシステムイメージをダウンロードしていることを確認し、インストールする前に署名やチェックサムを検証することから始めましょう。インストールするソフトウェアについても同様です。ダウンロードするソースやURLをダブルチェックする。ダウンロードしたソフトウェアの完全性と正しさを署名とチェックサムで検証する。</p>
</dd>
<dt class="hdlist1">メンテナンス</dt>
<dd>
<p>オペレーティングシステムを最新の状態に保つようにする。セキュリティアップデートを毎日または毎週自動的にインストールできるようにする。
最小限の権限：特定のプロセスにユーザーを設定し、サービスの実行に必要な最小限のアクセス権を与える。管理者権限（例：root）でプロセスを実行しないこと。</p>
</dd>
<dt class="hdlist1">プロセスの分離</dt>
<dd>
<p>OSの機能を使って、プロセスを互いに分離する。</p>
</dd>
<dt class="hdlist1">ファイルシステムのパーミッション</dt>
<dd>
<p>最小特権主義に基づき、慎重にファイルシステムを構成してください。ファイルを誰でも読み書きできるようにしないこと．</p>
</dd>
<dt class="hdlist1">強固な認証</dt>
<dd>
<p>ランダムに生成される強力なパスワードを使用するか、可能な限り公開鍵認証を使用する。例えば、Secure Shell（SSH）では、パスワードの代わりに暗号鍵ペアを使用するとより安全です。</p>
</dd>
<dt class="hdlist1">二要素認証（2FA）</dt>
<dd>
<p>ハードウェアセキュリティキーによるUniversal 2nd Factor (U2F)など、可能な限り二要素認証を使用する。これは、クラウドサービスプロバイダーなど、あなたが利用する可能性のあるすべての外部サービスに適用されます。また、自分自身のSSH設定など、自分自身のセットアップにも適用できます。間接的なサービスにも2FAを使用する。例えば、あなたがクラウドサービスを利用しているとします。クラウドサービスプロバイダにメールアドレスを教えたのですから、そのメールアドレスも2FAで保護する必要があります。</p>
</dd>
<dt class="hdlist1">バックアップ</dt>
<dd>
<p>システムのバックアップをとり、バックアップも暗号化して保護する。このバックアップは定期的に行ってください。少なくとも一度は、バックアップを復元できるかどうか、バックアップが完全でアクセス可能であるかどうかをテストしてください。可能であれば、バックアップのコピーを別のディスクに保存して、1つのハードディスク障害でアクティブノードとバックアップコピーの<em>両方が</em>破壊されるのを防ぐようにしてください。</p>
</dd>
<dt class="hdlist1">脆弱性・暴露管理</dt>
<dd>
<p>リモートスキャンを利用して、システムの攻撃対象領域を最小化する。不要なサービスやポートを閉じる。本当に必要で使用するソフトウェアやパッケージのみをインストールする。使用しなくなったパッケージはアンインストールする。他のコンピュータで実行できるノード以外のアクティビティには、ノード・コンピュータを使用<em>しない</em>ことをお勧めします。特に、可能であれば、ブラウジング、インターネット・サーフィン、電子メールを読むためにノード・コンピュータを使用<em>しない</em>ようにしてください。</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>これは、最も基本的なセキュリティ対策のリストです。決して網羅的なものではありません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_node_access">ノードアクセス</h4>
<div class="paragraph">
<p>Lightning ノードは、リモート プロシージャ コール (RPC) API を公開します。これは、特定の TCP ポートに送信されるコマンドによって、ノードをリモートで制御できることを意味します。RPC APIへのアクセス制御は、何らかのユーザー認証によって実現されます。設定するライトニング・ノードの種類によって、<span class="keep-together">ユーザー名/パスワード</span>認証または認証<em>マカロンと</em>呼ばれるメカニズムによって行われます。マカロンとは、その名の通り、より洗練されたクッキーの一種です。クッキーとは異なり、暗号的に署名され、一連のアクセス<span class="keep-together">能力を</span>表現することができます。</p>
</div>
<div class="paragraph">
<p>例えば、LND は RPC API へのアクセスを許可するためにマカロンを使用します。デフォルトでは、LND ソフトウェアは、admin、invoice、readonly と呼ばれるアクセス・レベルの異なる 3 つのマカロンを作成します。RPC クライアントでコピーして使用するマカロ ンに応じて、<em>読み取り専用</em>アクセス、請求<em>書</em>アクセス （読み取り専用機能を含む）、または完全制御が可能な<em>管理者</em>アクセスのいずれかを使用することができま す。また、LND にはマカロンベーカリー機能があり、非常にきめ細かい制御を行いながら、任意の機能の組み合わせでマカロンを構築することができます。</p>
</div>
<div class="paragraph">
<p>ユーザー名/パスワード認証モデルを使用する場合、長くてランダムなパスワードを選択することを確認してください。このパスワードは設定ファイルに保存されるため、頻繁に入力する必要はありません。したがって、推測できないようなものを選ぶべきです。あなたが見る多くの例には、不適切に選択されたパスワードが含まれており、しばしば人々はこれを自分のシステムにコピーし、誰にでも簡単にアクセスできるようにしています。そのようなことはしないでください。パスワードマネージャーを使って、ランダムな英数字からなる長いパスワードを生成してください。のような特定の特殊文字は、コマンドラインに干渉する可能性があるため、シェル環境で使用するパスワードにはこれらを避けることが最善です。問題を避けるために、長いランダムな英数字のパスワードにこだわってください。</p>
</div>
<div class="paragraph">
<p>通常、12 文字以上でランダムに生成される英数字の平文で十分です。ライトニングノードに大金を保存する予定で、リモートブルートフォース攻撃を懸念している場合、そのような攻撃が実質的に不可能になるように、20文字以上のパスワード長を選択します。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_node_and_channel_backups">ノードとチャンネルのバックアップ</h3>
<div class="paragraph">
<p>Lightning ノードを運用する際に非常に重要な考慮点は、バックアップの問題です。BIP-39のニーモニックフレーズでウォレットの状態をすべて回復できるビットコインウォレットと異なり、ライトニングではそうは<em>いきません</em>。</p>
</div>
<div class="paragraph">
<p>ライトニングウォレットは、BIP-39ニーモニックフレーズバックアップを使用しますが、オンチェーンウォレットにのみ使用されます。しかし、チャネルの構造上、ニーモニックフレーズだけではライトニングノードを復元するのに十分<em>では</em>ありません。<em>静的チャネルバックアップ</em><em>（SCB</em>）と呼ばれる追加バックアップのレイヤーが必要です。SCBがなければ、ライトニングノード運営者は、ライトニングノードのデータストアを失った場合、チャネルにある<em>すべての</em>資金を失う可能性があります。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">警告</div>
</td>
<td class="content">
<div class="paragraph">
<p>チャンネルの状態を継続的にバックアップするシステムを導入するまでは、チャンネルに資金を供給<em>しないで</em>ください。バックアップは、様々なシステム障害（停電、データ破損など）や自然災害（洪水、火災など）に耐えられるよう、ノードとは異なるシステムや場所に「オフサイト」しておく必要があります。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>SCBは万能ではありません。第一に、新しいコミットメントトランザクションが発生するたびに、各チャネルの状態をバックアップする必要があります。第二に、チャンネルのバックアップからの復元は危険です。<em>最後の</em>コミットメントトランザクションがなく、誤って古い（取り消された）コミットメントをブロードキャストした場合、チャネルピアはあなたが不正をしようとしていると判断し、ペナルティトランザクションでチャネル全体の残高を請求します。確実にチャネルをクローズするには、<em>協調的クローズを</em>行う必要があります。しかし、悪意のあるピアは、協同クローズ中にあなたのノードに古い取り消したコミットメントをブロードキャストするように誤解させ、それによってあなたのノードが不注意に不正を行おうとするように仕向けることができます。</p>
</div>
<div class="paragraph">
<p>さらに、あなたのチャンネルのバックアップは、あなたのプライバシーとチャンネルのセキュリティを維持するために暗号化する必要があります。そうしないと、バックアップを見つけた人は、あなたのチャンネルをすべて見ることができるだけでなく、バックアップを利用して、チャンネルの仲間に残高を渡す形ですべてのチャンネルを閉鎖することができます。言い換えれば、バックアップにアクセスした悪意のある人が、あなたのチャンネルの資金をすべて失う可能性があるということです。</p>
</div>
<div class="paragraph">
<p>SCBは完全な安全策ではないことがおわかりいただけると思います。SCB はある種のリスク（データの破損や損失）を別の種のリスク（悪意のあるピア）と交換するため、弱い妥協の産物なのです。SCBから復元するためには、チャネルのピアと対話し、彼らが古いコミットメントを与えたり、あなたのノードを騙して、あなたにペナルティを与えるために取り消されたコミットメントをブロードキャストさせたりして、あなたを騙そうとしないように願う必要があります。SCB の弱点にもかかわらず、SCB は意味があり、あなたはそれを実行すべきです。もし SCB を行わず、ノードのデータを失うと、チャンネル資金を永遠に失うことになります。保証します!しかし、もしあなたがSCBを<em>実行</em>し、ノードデータを失った場合、あなたのピアの何人かは正直であり、あなたのチャネル資金の一部を回復できる合理的なチャンスがあります。運が良ければ、すべての資金を回復できるかもしれません。結論として、プライマリノードのハードディスク以外のディスクに SCB を継続的に実行することが最善です。</p>
</div>
<div class="paragraph">
<p>チャンネルバックアップの仕組みはまだ未完成であり、ほとんどのライトニングの実装において弱点となっています。</p>
</div>
<div class="paragraph">
<p>この本を書いている時点では、LND だけが SCB のためのビルトインメカニズムを提供しています。Eclair Mobile は Google Drive へのバックアップをオプションで提供していますが、Eclair も同様のメカニズムをサーバーサイドに配備しています。残念ながら、異なるノードの<span class="keep-together">実装</span>間で一貫性のある合意されたバックアップメカニズムはありません。</p>
</div>
<div class="paragraph">
<p>Lightning ノード データベースのファイルベースのバックアップは、一貫性のないデータベース状態をバックアップするリスクがあるため、せいぜい部分的な解決策にすぎません。また、最新の状態のコミットメントを確実にキャッチできない可能性があります。チャネルの状態が変化するたびにトリガーされるバックアップメカニズムがあれば、データの一貫性が確保され、はるかに優れています。</p>
</div>
<div class="paragraph">
<p>LND で SCB をセットアップするには、コマンドラインまたは設定ファイルで backupfilepath パラメータを設定します。LND はその後、そのディレクトリパスに SCB ファイルを保存します。もちろん、これはソリューションの最初のステップに過ぎません。さて、このファイルの変更を監視するメカニズムをセットアップする必要があります。ファイルが変更されるたびに、<span class="keep-together">バックアップ機構は</span>このファイルを別の、できればオフサイトのディスクにコピーしなければならない。このようなバックアップ機構は、この本の範囲外である。しかし、洗練されたバックアップソリューションは、このシナリオを処理することができるはずです。バックアップファイルは暗号化されている必要があります。</p>
</div>
<div class="sect3">
<h4 id="_hot_wallet_risk">ホットウォレットのリスク</h4>
<div class="paragraph">
<p>前回説明したように、ライトニングネットワークは、<em>ホットウォレットの</em>ネットワークで構成されています。ライトニングウォレットに保管された資金は、常にオンライン状態にある。そのため、脆弱性があります。したがって、Lightningウォレットに多額の資金を保管するべきではありません。多額の資金は、オンラインで<em>なく</em>、オンチェーンのみで取引可能な<em>コールドウォレットに</em>保管する必要があります。</p>
</div>
<div class="paragraph">
<p>最初は小さくても、時間が経つとライトニングの財布の中に相当な金額が入っていることがあります。これは、店舗経営者の典型的なシナリオです。Lightningノードをeコマースの運営に使用している場合、ウォレットは頻繁に資金を受け取ることができますが、資金を送ることはほとんどありません。そのため、同時に2つの問題を抱えることになります。まず、ローカルの残高が多く、リモートの残高が少ないというアンバランスな状態になります。次に、財布の中の資金が多すぎることです。幸いなことに、この2つの問題を同時に解決することも可能です。</p>
</div>
<div class="paragraph">
<p>ホットウォレットで露出する資金を減らすために使える解決策を見てみましょう。</p>
</div>
</div>
<div class="sect3">
<h4 id="_sweeping_funds">スイープファンド</h4>
<div class="paragraph">
<p>Lightningウォレットの残高が自分のリスク許容度に対して大きくなりすぎた場合、ウォレットから資金を「スイープ」する必要があります。これを行うには、オンチェーン、オフチェーン、ループアウトの3つの方法があります。次のセクションで、これらのオプションのそれぞれについて見てみましょう。</p>
</div>
<div class="sect4">
<h5 id="_on_chain_sweep">オンチェーン・スイープ</h5>
<div class="paragraph">
<p>オンチェーンでの資金掃討は、ライトニングウォレットからビットコインウォレットに資金を移動させることで実現します。そのためには、チャネルを閉じる必要があります。チャネルを閉じると、ローカル残高からすべての資金がビットコインアドレスに「掃引」されます。オンチェーン資金用のビットコインアドレスは通常、ライトニングウォレットによって生成されるので、ホットウォレットであることに変わりはありません。ハードウェアウォレットで生成されたものなど、より安全なアドレスに資金を移動するために、追加のオンチェーン取引が必要な場合があります。</p>
</div>
<div class="paragraph">
<p>チャネルをクローズすると、オンチェーン料金が発生し、ライトニングノードの容量と接続性が低下します。しかし、人気のあるeコマースノードを運営している場合、受信容量が不足することはなく、ローカル残高が大きいチャネルを戦略的にクローズし、オンチェーンでの移動のために資金を実質的に「束ねる」ことが可能です。この戦略の利点を最大化するために、チャネルを閉じる前に、いくつかのチャネルリバランシングテクニック（<a href="#channel_rebalancing">チャネルのリバランシングを</a>参照）を使用する必要があるかもしれません。</p>
</div>
</div>
<div class="sect4">
<h5 id="_off_chain_sweep">オフチェーンスイープ</h5>
<div class="paragraph">
<p>もう一つの方法は、ネットワーク上で宣伝していない2番目のライトニング・ノードを稼働させることです。公開ノード（例えば、ショップを運営しているノード）から非広告ノード（隠しノード）へ大容量のチャネルを確立することができます。定期的に、隠しノードにLightningで支払いを行い、資金を「掃き出す」ことができます。</p>
</div>
<div class="paragraph">
<p>この手法の利点は、ショップの支払いを受けるライトニングノードが公開されることにあります。ショップに関連するLightningノードがあれば、多額の残高があると見なされるため、ハッカーの標的になります。ショップに関連しない2番目のノードは、貴重なターゲットとして簡単に識別されることはありません。</p>
</div>
<div class="paragraph">
<p>さらなるセキュリティ対策として、2番目のノードを隠しTorサービスにして、そのIPアドレスを知られないようにすることができます。これにより、さらに攻撃の機会を減らし、プライバシーを向上させることができます。</p>
</div>
<div class="paragraph">
<p>定期的に実行されるスクリプトをセットアップする必要があります。このスクリプトの目的は、あなたのHiddenノードに請求書を作成し、あなたのショップのノードからその請求書を支払うことで、あなたのHiddenノードに資金を移動させることである。</p>
</div>
<div class="paragraph">
<p>この手法では、資金をコールドストレージに移動させることはできないことに留意してください。Lightningノードは両方ともホットウォレットです。この掃討作戦の目的は、非常に有名なホットウォレットから無名のホットウォレットに資金を移動させることです。</p>
</div>
</div>
<div class="sect4">
<h5 id="_submarine_swap_sweep">潜水艦スワップスイープ</h5>
<div class="paragraph">
<p>Lightningホットウォレットの残高を減らすもう一つの方法は、サブマリン<em>・スワップという</em>手法を使うことです。サブマリンスワップは、共著者のOlaoluwa Osuntokun氏とAlex Bosworth氏が概念化したもので、オンチェーンのビットコインをLightningの支払いに、またはその逆に交換することができます。基本的にサブマリンスワップは、ライトニングのオフチェーン資金とビットコインのオンチェーン資金との間のアトミックなスワップです。</p>
</div>
<div class="paragraph">
<p>ノードオペレータはサブマリンスワップを開始し、利用可能なすべてのチャネル残高を相手方に送り、相手方はそれと引き換えにオンチェーンビットコインを送ることができます。</p>
</div>
<div class="paragraph">
<p>将来的には、ライトニング・ネットワークのノードが為替レートを広告したり、変換に一律の料金を課したりして提供する有料サービスになる可能性があります。</p>
</div>
<div class="paragraph">
<p>サブマリン・スワップによる資金掃討のメリットは、チャネルを閉じる必要がないことです。つまり、チャンネルを維持し、この操作によってチャンネルのバランスを調整するだけです。ライトニングを送信する際、1つまたは複数のチャンネルでローカルからリモートに残高を移動させます。これにより、ノードのホットウォレットの残高が減少するだけでなく、将来の支払いに利用できる残高が増加します。</p>
</div>
<div class="paragraph">
<p>ゲートウェイとなる仲介者を信頼することで可能ですが、その場合、コインを盗まれるリスクがあります。しかし、サブマリン・スワップの場合、この操作に信頼は必要ない。サブマリン・スワップは非親告罪の<em>原子</em>操作です。つまり、オンチェーンでの支払いはオフチェーンでの支払いの完了に依存し、その逆もまた然りなので、サブマリンスワップのカウンターパーティはあなたの資金を盗むことができないのです。</p>
</div>
</div>
<div class="sect4">
<h5 id="_submarine_swaps_with_loop">潜水艦がLoopと入れ替わる</h5>
<div class="paragraph">
<p>海底交換サービスの一例として、LNDを構築しているLightning Labs社の<em>Loopが</em>あります。Loopには2つのバリエーションがある。Loop InとLoop Outだ。<em>Loop Inは</em>、ビットコインのオンチェーン決済を受け入れ、それをLightningのオフチェーン決済に変換する。Lo<em>op Outは</em>、Lightningの支払いをBitcoinの支払いに変換する。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">備考</div>
</td>
<td class="content">
<div class="paragraph">
<p>Loop サービスを利用するには、LND Lightning ノードが動作している必要があります。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Lightningホットウォレットの残高を減らす目的では、Loop Outサービスを利用することになります。Loop サービスを使用するには、ノードにいくつかの追加ソフトウェアをインストールする必要があります。Loopソフトウェアは、LNDノードと一緒に動作し、サブマリンスワップを実行するためのいくつかのコマンドラインツールを提供します。Loopソフトウェアとインストール方法は、<a href="https://github.com/lightninglabs/loop">GitHubに</a>あります。</p>
</div>
<div class="paragraph">
<p>ソフトウェアをインストールし、実行すれば、ループアウトの操作は1つのコマンドを実行するだけで簡単に行えます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ループアウト --amt 501000 --conf_target 400
501000 sat ループアウトの最大スワップ料：25716 sat
通常のスワップ速度が要求され、スワップが実行されるまで最大30m0sかかる場合があります。
スワップを継続しますか？(y/n), 展開料金詳細 (x): x

オンチェーンスイープ料金の見積もり: 149 sat
最大オンチェーンスイープ料金: 14900 sat
最大オフチェーン・スワップ・ルーティング料金: 10030 sat
最大ノーショー・ペナルティ(プリペイ)。        1337サット
最大オフチェーンプリペイルーティング手数料: 36 sat
最大スワップ料: 750 sat
スワップを継続しますか？(y/n): y
スワップが開始されました

ループモニター`を実行し、進捗状況を確認する。</pre>
</div>
</div>
<div class="paragraph">
<p>なお、最大手数料（最悪の場合）は、選択した確認対象によって異なります。</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lightning_node_uptime_and_availability">Lightningノードのアップタイムとアベイラビリティ</h3>
<div class="paragraph">
<p>ビットコインと異なり、ライトニングノードはほぼ継続的にオンラインである必要があります。ノードは、支払いの受け取り、チャネルのオープン、チャネルのクローズ（協調）、プロトコル違反の監視のためにオンラインである必要があります。ノードの可用性はライトニングネットワークにおいて非常に重要な要件であり、様々な自動チャネル管理ツール（例：オートパイロット）がどのノードとチャネルを開くかを決定するための指標として使用されているほどです。また、<a href="https://1ml.com">1ML</a> などの一般的なノードエクスプローラ（<a href="#ln_explorer">[ln_explorer]</a>を参照）でも、ノードのメトリックとして「アベイラビリティ」を見ることができます。</p>
</div>
<div class="paragraph">
<p>ノードの可用性は、潜在的なプロトコル違反（すなわち、取り消されたコミットメント）を軽減し解決するために特に重要です。1時間から1～2日の短時間の中断は許容されますが、資金損失のリスクなしに長時間ノードをオフラインにすることはできません。</p>
</div>
<div class="paragraph">
<p>ノードを継続的にオンラインにしておくことは簡単ではありません。様々なバグやリソースの制限によってダウンタイムが発生する可能性がありますし、今後も発生するでしょう。特に多忙で人気のあるノードを運営していると、メモリ、スワップスペース、オープンファイルの数、ディスクスペースなどの制限にぶつかるでしょう。様々な問題があなたのノードやサーバーをクラッシュさせる原因となるのです。</p>
</div>
<div class="sect3">
<h4 id="_tolerate_faults_and_automate">故障を許容し、自動化する</h4>
<div class="paragraph">
<p>もし時間とスキルがあるのなら、Lightningテストネットで基本的な障害シナリオをテストしてみてはいかがでしょうか。テストネットでは、資金をリスクにさらすことなく、貴重な教訓を得ることができます。システムを自動化するために行うどのようなステップも、お客様の可用性を向上させます。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">コンピューター・サーバーの自動再起動</dt>
<dd>
<p>サーバーやOSがクラッシュしたらどうする？停電になったらどうなるのでしょうか？PCの「リセット」ボタンを押すか、電源ケーブルを抜いて、この障害をシミュレートしてください。クラッシュ、リセット、または停電の後、コンピューターは自動的に再起動するはずです。一部のコンピュータでは、BIOSに電源障害時のコンピュータの動作を指定する設定があります。この設定を試して、コンピュータが本当に人手を介さずに自動的に再起動することを確認してください。</p>
</dd>
<dt class="hdlist1">ノードの自動再起動</dt>
<dd>
<p>自分のノードやノードの1つがクラッシュするとどうなるのでしょうか？対応するノードのプロセスをkillすることで、このフォルトをシミュレートしてください。ノードがクラッシュした場合、自動的に再起動するはずです。ノードが本当に人手を介さずに自動的に再起動するかテストしてください。そうでない場合は、ノードがOSサービスとして正しくセットアップされていない可能性が高いです。</p>
</dd>
<dt class="hdlist1">ネットワーク自動再接続</dt>
<dd>
<p>ネットワークがダウンした場合はどうなりますか？ISPが一時的にダウンした場合はどうなりますか？ISPがルーターやコンピューターに新しいIPアドレスを割り当てた場合はどうなるのでしょうか？ネットワークが復旧したとき、実行中のノードは自動的にネットワークに再接続されますか？ノードをホストしているデバイスからイーサネットケーブルを抜き、後で再接続して、この障害をシミュレートしてください。ノードが自動的に再接続され、人手を介さずに動作が継続するはずです。</p>
</dd>
<dt class="hdlist1">ログファイルの設定</dt>
<dd>
<p>上記のすべての失敗は、対応するログファイルにテキスト形式のエントリを残す必要があります。必要であれば、ロギングの冗長性を上げてください。ログファイルからこれらのエラーエントリを見つけ、監視に利用する。</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_monitoring_node_availability">ノードの可用性を監視する</h4>
<div class="paragraph">
<p>ノードの監視は、ノードを稼働させ続けるための重要な要素です。コンピュータ自体の可用性だけでなく、Lightning ノード ソフトウェアの可用性と正しい動作も監視する必要があります。</p>
</div>
<div class="paragraph">
<p>これを行う方法はいくつかありますが、ほとんどの場合、何らかのカスタマイズが必要です。一般的なインフラ監視ツールやアプリケーション監視ツールを使用することもできますが、Lightning ノード API を照会してノードが実行され、ブロックチェーンに同期し、チャネルピアーに接続されていることを確認するために、それらを特別にカスタマイズする必要があります。</p>
</div>
<div class="paragraph">
<p><a href="https://lightning.watch">Lightning.watchは</a>、Lightningノードの監視を提供する専門サービスです。これはTelegramボットを使用して、サービスの中断を通知します。これは無料のサービスですが、より速くアラートを受け取るためにお金を払うこともできます（もちろんLightningで）。</p>
</div>
<div class="paragraph">
<p>いずれは、マイクロペイメントで支払えるライトニングノード専用のモニタリングサービスを提供するサードパーティも増えてくると思われます。おそらくそのようなサービスとそのAPIは標準化され、いつの日かライトニングノードのソフトウェアによって直接サポートされるようになるでしょう。</p>
</div>
</div>
<div class="sect3">
<h4 id="watchtowers">監視塔</h4>
<div class="paragraph">
<p><em>ウォッチタワーは</em>、ライトニングプロトコル違反の監視とペナルティ解決をアウトソーシングするための仕組みです。</p>
</div>
<div class="paragraph">
<p>前の章で述べたように、ライトニングプロトコルはペナルティメカニズムによってセキュリティを維持しています。チャネルパートナーの1社が古いコミットメントトランザクションをブロードキャストした場合、あなたのノードは失効条項を行使して、損失を避けるためにペナルティトランザクションをブロードキャストする必要があります。しかし、プロトコル違反の間にあなたのノードがダウンした場合、あなたはお金を失うかもしれません。</p>
</div>
<div class="paragraph">
<p>この問題を解決するには、1つ以上のウォッチタワーを使用して、プロトコル違反の監視とペナルティ取引の発行の仕事を外注することができます。ブロックチェーンを監視するウォッチタワー・サーバー（または単にウォッチタワー）と、この監視サービスをウォッチタワー・サーバーに依頼するウォッチタワー・クライアントの2つの部分があります。</p>
</div>
<div class="paragraph">
<p>Watchtowerの技術はまだ開発の初期段階にあり、広くサポートされているわけではありません。しかし、以下の文章では、あなたが試すことができる実験的な実装をいくつかリストアップしています。</p>
</div>
<div class="paragraph">
<p>LND ソフトウェアには、watchtower サーバーと watchtower クライアントの両方が含まれています。以下の設定オプションを追加することで、watchtower サーバをアクティブにすることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[ウォッチタワー］
watchtower.active=1
ウォッチタワー.towerdir=/path_to_watchtower_data_directory</code></pre>
</div>
</div>
<div class="paragraph">
<p>LNDのwatchtowerクライアントをコンフィギュレーションで有効化し、コマンドラインでwatchtowerサーバーに接続することで利用できます。コンフィギュレーションは</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[wtclient】の場合］
wtclient.active=1</pre>
</div>
</div>
<div class="paragraph">
<p>LND のコマンドラインクライアント lncli は、watchtower クライアントを管理するための以下のオプションを表示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>lncli wtclient

名前
   lncli wtclient - ウォッチタワークライアントと対話します。

使用方法
   lncli wtclient コマンド [コマンドオプション] [引数...]。

COMMANDS
     add 将来のセッション/バックアップに使用する監視対象を登録します。
     remove ウォッチタワーを削除して、今後のセッション/バックアップで使用できないようにします。
     towers 登録されているすべてのウォッチタワーの情報を表示します。
     tower 登録された特定のウォッチタワーの情報を表示します。
     stats ウォッチタワークライアントのセッション統計情報を表示します。
     policy アクティブなウォッチタワー・クライアントのポリシー設定を表示します。

OPTIONS
   --help, -h ヘルプを表示します。</pre>
</div>
</div>
<div class="paragraph">
<p><code>c-lightningは</code>、watchtowerクライアントプラグインに必要なAPIフックを備えていますが、そのようなプラグインはまだ実装されていません。</p>
</div>
<div class="paragraph">
<p>最後に、スタンドアローンのウォッチタワーサーバーとして人気があるのが、<em>The Eye of Satoshi</em>(TEOS)です。これは<a href="https://github.com/talaia-labs/python-teos">GitHubで</a>見つけることができます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_channel_management">チャネルマネジメント</h3>
<div class="paragraph">
<p>ライトニングノードオペレータとして、繰り返し行う必要があるタスクの1つは、チャンネルの管理です。これは、自分のノードから他のノードへのアウトバウンドチャネルを開いたり、他のノードから自分のノードへのインバウンドチャネルを開いてもらったりすることを意味します。将来的には、協調的なチャネル構築が可能になり、作成時に両端に資金がコミットされる対称的なチャネルを開くことができるようになるかもしれません。しかし、今のところ、新しいチャネルは一方の端（発信者側）にしか資金がありません。したがって、自分のノードをインバウンドとアウトバウンドの両方の容量で<em>バランス</em>させるには、他の人にチャネルを開き、他の人が自分のノードにチャネルを開くように誘惑する必要があります。</p>
</div>
<div class="sect3">
<h4 id="_opening_outbound_channels">アウトバウンドチャネルの開設</h4>
<div class="paragraph">
<p>ライトニングノードを立ち上げたら、すぐにそのビットコインウォレットに資金を供給し、その資金でチャンネルを開き始めることができます。</p>
</div>
<div class="paragraph">
<p>ノードの支払い能力は、チャネルパートナーが誰で、ライトニングネットワークの他の部分とどれだけうまく接続されているかに依存するため、チャネルパートナーを慎重に選択する必要があります。また、単一障害点の影響を受けないように、複数のチャネルを持つことをお勧めします。Lightningはマルチパート決済をサポートしているので、初期資金を複数のチャネルに分割し、その能力を組み合わせることでより大きな決済をルーティングすることができます。同時に、チャンネルを小さくしすぎないようにしましょう。チャネルの開設と閉鎖にはビットコインの取引手数料が必要なので、チャネル残高が小さすぎてオンチェーン手数料が大きな割合を占めるようなことがあってはならないのです。バランスが大事なんです!</p>
</div>
<div class="paragraph">
<p>要約すると</p>
</div>
<div class="ulist">
<ul>
<li>
<p>接続性の高い少数のノードに接続する</p>
</li>
<li>
<p>複数のチャンネルを開く</p>
</li>
<li>
<p>チャンネルを開きすぎない</p>
</li>
<li>
<p>チャンネルを小さくしすぎない</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>接続の良いノードを見つける方法の1つは、ライトニング・ネットワークで製品を販売している人気のあるマーチャントへのチャネルを開くことです。これらのノードは、資金が豊富で、接続が良好な傾向があります。そのため、Lightningを使ってオンラインで何かを購入する準備ができたら、そのマーチャントのノードに直接チャネルを開くことができます。マーチャントのノードIDは、何かを買おうとしたときに受け取るインボイスに記載されています。これなら簡単ですね。</p>
</div>
<div class="paragraph">
<p>接続の良いノードを見つけるもう一つの方法は、<a href="https://1ml.com">1MLなどの</a>Lightning Explorer（<a href="#ln_explorer">[ln_explorer]</a>を参照）を使用し、チャネル容量とチャネル数でソートしたノードのリストをブラウズすることです。中央集権を助長するため、最大のノードは選ばないようにしましょう。リストの真ん中にあるノードを選ぶと、そのノードの成長を手助けすることができます。もう1つの考慮すべき点は、ノードが運用されている期間です。1年以上前に設立されたノードは、1週間前に運用を開始したノードよりも評判が良く、リスクが低い可能性があります。</p>
</div>
<div class="sect4">
<h5 id="autopilot">オートパイロット</h5>
<div class="paragraph">
<p><em>オート</em>パイロットは、発見的なルールに基づいて自動的にチャネルを開くソフトウェアで、チャネルを開くタスクを部分的に自動化することができます。オートパイロット・ソフトウェアはまだ比較的新しいもので、必ずしも最適なチャネル・パートナーを選択してくれるとは限りません。特に最初のうちは、手動でチャネルを開設する方がよいかもしれません。
オートパイロットは現在3つの形態で存在している。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lndには、lndと完全に統合されたオートパイロットが組み込まれており、電源が入っている間はバックグラウンドで常に稼働しています。</p>
</li>
<li>
<p>lib_autopilot.py は、ゴシップとチャンネルデータに基づいて、任意のノード実装の自動操縦の計算を提供することができます。</p>
</li>
<li>
<p>lib_autopilot.py をベースにした c-lightning プラグインが存在し、c-lightning ユーザーのために使いやすいインターフェイスを提供します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>lndオートパイロットは、設定ファイルを介してオンにされるとすぐにバックグラウンドで実行を開始することに注意してください。その結果、lndウォレットにオンチェーン出力がある場合、すぐにチャンネルを開き始めます。
もし、あなたが行うビットコイン取引とあなたが開くチャンネルを完全に制御したい場合、ビットコイン資金でlndウォレットをロードする<em>前に</em>オートパイロットをオフにしてください。
自動操縦が以前オンになっていた場合、オンチェーン取引でウォレットをトップアップする前やチャンネルを閉じる前に、lndを再起動する必要があるかもしれません。
オートパイロットを実行したい場合は、主要な設定値を設定することが重要です。
この設定例を見てください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[lnd-autopilot]です。
autopilot.active=1
オートパイロット最大チャネル数=40
オートパイロット配分量=0.70
オートパイロット.ミンシャンサイズ=500000
オートパイロット.マックスチャンサイズ=5000000
autopilot.heuristic=top_centrality:1.0とする。</pre>
</div>
</div>
<div class="paragraph">
<p>この設定ファイルにより、オートパイロットが起動します。
以下の2つの条件が満たされる限り、チャンネルを開くことができます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>あなたのノードでは、現在40チャンネル以下しか開いていません。</p>
</li>
<li>
<p>総資金の70％以下が決済チャネルでオフチェーンになっています。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>40と0.7という数字は、ここでは完全に任意に選んだものです。なぜなら、いくつのチャンネルを開くべきか、資金の何パーセントをオフチェーンにすべきかについて、万人に有効な推奨をすることはできないからです。
lndのオートパイロットは、オンチェーン手数料を考慮しません。言い換えれば、手数料が低い時間帯にチャンネルを開くのを遅らせることはありません。
手数料を減らすには、手数料が低い時間帯（週末など）に手動でチャネルを開くとよいでしょう。
自動操縦は、この条件が満たされるたびにチャネル推薦を行い、適切な現在の手数料を使用して直ちにチャネル開設を試みます。
先の設定ファイルによると、チャンネルのサイズは5 mBTC<code>(minchansize</code>= 500,000 satoshi) から 50 mBTC<code>(maxchansize</code>= 5,000,000 satoshi) の間となります。
一般的に、設定ファイルの金額はsatoshiで列挙されています。
現在、1mBTC以下のチャンネルはあまり有用ではないので、小さすぎてこの金額以下のチャンネルを開設することはお勧めしません。
マルチパート決済の普及に伴い、より小さなチャンネルは負担が少なくなっています。しかし、当面は、これが私たちの推奨する方法です。</p>
</div>
<div class="paragraph">
<p>本書の共著者であるRené Pickhardtによって書かれたc-lightningプラグインは、lndオートパイロットと比較して、非常に異なる動作をします。
まず、推薦を行うためのアルゴリズムが異なります。この点については、ここでは触れません。次に、ユーザーインターフェイスが異なります。
c-lightningの<a href="https://github.com/lightningd/plugins/tree/master/autopilot">プラグインリポジトリから</a> <em>オートパイロットのプラグインを</em>ダウンロードし、それを有効にする必要があります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">備考</div>
</td>
<td class="content">
<div class="paragraph">
<p>c-lightningでプラグインを有効にするには、<em>~/.lightning/plugins</em>ディレクトリに置き、実行可能であることを確認し（例：<code>chmod +x ~/.lightning/plugins/autopilot.py</code> ）、 lightningdを再起動します。</p>
</div>
<div class="paragraph">
<p>また、lightningd の起動時にプラグインを自動起動させたくない場合は、別のディレクトリに配置し、lightningd の plugin 引数で手動で起動させることもできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   lightningd --plugin=~/lightning-plugins/autopilot.py</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>c-lightningのオートパイロットは3つの設定値で制御され、設定ファイルまたはlightningdの起動時にコマンドライン引数として設定することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[c-lightning-autopilot】です。］
オートパイロット率=75
オートパイロット数-チャンネル数=10
autopilot-min-channel-size-msat=100000000msat</pre>
</div>
</div>
<div class="paragraph">
<p>これらの値は実際のデフォルトの設定値であり、設定する必要は全くありません。</p>
</div>
<div class="paragraph">
<p>オートパイロットは lnd のようにバックグラウンドで自動的に実行されることはありません。
その代わり、オートパイロットが推奨するチャンネルを開くには<code>lightning-cli autopilot-run-once</code>で特別に実行を開始する必要があります。
しかし、単に推奨されるノードを提供し、そこからノードを選択したい場合は、オプションの<code>dryrun</code>引数を追加することができます。</p>
</div>
<div class="paragraph">
<p>lndとc-lightningのオートパイロットの重要な違いは、c-lightningのオートパイロットはチャンネルサイズについても推奨を行うことです。
例えば、オートパイロットが小さなチャンネルしか持たないノードとのチャンネル開設を推奨した場合、大きなチャンネル開設を推奨することはありません。
しかし、多くの大規模なチャネルを持つ、接続の良いノードとチャネルを開く場合は、おそらくより大きなチャネルサイズを推奨します。</p>
</div>
<div class="paragraph">
<p>このように、c-lightningのオートパイロットは、lndのものほど自動化されていませんが、少しコントロールしやすくなっています。
これらの違いは、個人の好みを反映したものであり、実際にどちらかの実装を選択する決め手となる可能性があります。</p>
</div>
<div class="paragraph">
<p>現在のオートパイロットは、主にライトニングネットワークの現在のトポロジーに関するゴシッププロトコルの公開情報を使用することに留意してください。
当然ながら、チャンネルに対する個人的な要望はある程度までしか反映されません。
より高度なオートパイロットでは、ルーティングの成功に関する情報、過去に誰にお金を払ったか、誰にお金を払ったかなど、ノードが過去に実行した際に収集した履歴や使用情報を使用することになります。
将来的には、このような改良型オートパイロットは、収集したデータを使って、チャンネルの閉鎖や資金の再配分を推奨することもできるようになるかもしれません。</p>
</div>
<div class="paragraph">
<p>本書の執筆時点では、オートパイロットに過度に依存しないよう、注意が必要です。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getting_inbound_liquidity">インバウンドの流動性を得る</h4>
<div class="paragraph">
<p>現在のライトニングネットワークの設計では、ユーザーはインバウンドの流動性を得る<em>前に</em>アウトバウンドの流動性を得ることがより一般的です。
ユーザーは他のノードとのチャネルを開くことでそうし、ビットコインを受け取る前に使うことができるようになることが多くなります。
インバウンドの流動性を得るには、3つの典型的な方法があります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>アウトバウンドの流動性を持つチャネルを開設し、その資金の一部を使う。これでチャネルの反対側に残高があることになり、支払いを受け取ることができる。</p>
</li>
<li>
<p>誰かに頼んで、あなたのノードとのチャンネルを開いてもらいましょう。あなたのノードがより良くつながり、バランスが取れるように、相互援助を申し出ましょう。</p>
</li>
<li>
<p>サブマリンスワップ（Loop Inなど）を使って、オンチェーンBTCを自分のノードへのインバウンドチャンネルと交換します。</p>
</li>
<li>
<p>サードパーティーのサービスにお金を払って、チャンネルを開いてもらう。そのようなサービスはいくつか存在します。流動性を提供するために手数料を取るものもあれば、無料のものもある。</p>
</li>
</ul>
</div>
<div class="paragraph pagebreak-before">
<p>ここでは、現在利用可能な流動性プロバイダーのうち、手数料を支払うことでお客様のノードにチャネルを開くことができるプロバイダーをご紹介します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.bitrefill.com/thor-lightning-network-channels">BitrefillのThorサービス</a></p>
</li>
<li>
<p><a href="https://lightningto.me">ライトニング・トゥ・ミー</a></p>
</li>
<li>
<p><a href="https://lnbig.com">エルエヌビッグ</a></p>
</li>
<li>
<p><a href="https://lightningconductor.net/channels">雷導体</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>インバウンド流動性の創出は、実用面とユーザーエクスペリエンス面の両方から見て困難なものです。インバウンドの流動性は自動的に発生するものではないので、ノードに合わせて構築する方法を見つけなければならない。このような支払いチャネルの非対称性は、直感的なものではありません。他のほとんどの決済システムでは、自分が先に支払い（インバウンド）を受けてから、他の人に支払う（アウトバウンド）。</p>
</div>
<div class="paragraph">
<p>インバウンド流動性の確保という課題は、マーチャントやライトニング決済でサービスを販売している場合に顕著に現れます。その場合、支払いを受け続けられるだけのインバウンド流動性を確保するために、警戒が必要です。あなたのストアに購入者が急増しても、インバウンドのキャパシティがもうないため、実際に支払いができない場合はどうでしょうか？</p>
</div>
<div class="paragraph">
<p>将来的には、このような課題は、双方から資金を調達し、インバウンドとアウトバウンドの容量をバランスよく提供するデュアルファンドチャネルの導入により、部分的に軽減することが可能です。また、より洗練された自動操縦ソフトウェアによって、必要に応じてインバウンドの容量を要求し、支払うことで、負担を軽減することができます。</p>
</div>
<div class="paragraph">
<p>最終的には、ライトニングのユーザーは、戦略的かつ積極的にチャネル管理を行い、ニーズに応じた十分なインバウンドのキャパシティを確保する必要があります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_closing_channels">チャンネルを閉じる</h4>
<div class="paragraph">
<p>本書で前述したように、チャネルを閉じるには<em>相互のクローズが</em>望ましい。しかし、<em>強制終了</em>が必要な場合もある。</p>
</div>
<div class="paragraph">
<p>いくつかの例を挙げます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>チャネルパートナーがオフラインで、相互接続を開始するための連絡ができない。</p>
</li>
<li>
<p>チャネルパートナーはオンラインだが、相互接続を開始するためのリクエストに応答しない。</p>
</li>
<li>
<p>チャネルパートナーはオンラインであり、ノードが相互に閉じる交渉をしているが、彼らは立ち往生し、解決に到達することはできません。</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="channel_rebalancing">チャネルのリバランス</h4>
<div class="paragraph">
<p>Lightningで取引や決済を行う過程で、インバウンドとアウトバウンドの容量の組み合わせがアンバランスになることがあります。</p>
</div>
<div class="paragraph">
<p>たとえば、チャネル・パートナーの1社が頻繁に自社のノードを経由して支払いを行っている場合、そのチャネルのインバウンドキャパシティを使い果たすと同時に、アウトバウンドチャネルのアウトバウンドキャパシティも使い果たすことになります。そうなれば、もうそのルートで決済を行うことはできません。</p>
</div>
<div class="paragraph">
<p>チャンネルのリバランスには多くの方法があり、それぞれ長所と短所があります。1つの方法は、本章で前述したように、サブマリン・スワップ（Loop Outなど）を使用することである。リバランスのもう一つの方法は、単純に反対方向に流れるルーティングされた支払いを待つことです。ノードがよく接続されている場合、特定のルートが一方向に枯渇すると、同じルートが反対方向で利用可能になります。他のノードは反対方向のそのルートを「発見」して、支払い経路の一部として使い始めるかもしれず、それによって資金が再びバランスされる。</p>
</div>
<div class="paragraph">
<p>チャンネルをバランスさせる3つ目の方法は、自分のノードからライトニングネットワーク経由で自分のノードに支払いを送り返す<em>循環ルートを</em>意図的に作ることです。ローカルで大きな容量を持つチャネルで支払いを送信し、リモートで大きな容量を持つチャネルで自分のノードに戻るように経路を配置することで、これらのチャネルの両方がよりバランスされるようになります。循環経路リバランシング戦略の例は、<a href="#circular_rebalancing">循環経路リバランシングで</a>見ることができます。</p>
</div>
<div id="circular_rebalancing" class="imageblock">
<div class="content">
<img src="images/mtln_0504.png" alt="mtln 0504" />
</div>
<div class="title">図4．円形ルートバランサー</div>
</div>
<div class="paragraph">
<p>円形リバランスは、ほとんどのライトニングノードの実装でサポートされており、コマンドラインまたは Ride The Lightning などの Web 管理インターフェイスのいずれかを介して行うことができます (<a href="#rtl">Ride The Lightning を</a>参照)。</p>
</div>
<div class="paragraph">
<p>チャンネルのリバランスは複雑な問題で、活発な研究の対象であり、「<a href="#channel_rebalancing">チャンネルのリバランス</a>」でより詳しく取り上げています。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_routing_fees">ルーティングフィー</h3>
<div class="paragraph">
<p>ライトニングノードを運営することで、チャネル間で支払いをルーティングすることで手数料を得ることができます。ルーティング手数料は一般的に大きな収入源ではなく、ノードの運用コストに比べれば微々たるものです。例えば、1日に12件の決済をルーティングする比較的忙しいノードでは、手数料は2,000サトシ以下となります。</p>
</div>
<div class="paragraph">
<p>ノードは、各チャネルで希望する手数料率を設定することで、ルーティングフィーを獲得するために競争します。ルーティングフィーは、各チャネルの2つのパラメータによって設定されます。すなわち、あらゆる支払いに課される固定<em>基本</em>料金と、支払額に比例する追加可変<em>料金</em>です。</p>
</div>
<div class="paragraph">
<p>ライトニング決済を行う場合、ノードは手数料を最小にするか、ホップを最小にするか、またはその両方を行うように経路を選択します。その結果、これらの相互作用から経路選択手数料の市場が生まれます。現在、ルーティングの手数料が非常に低いか無料のノードが多数存在し、ルーティング手数料市場に下落圧力がかかっています。</p>
</div>
<div class="paragraph">
<p>何も選択しない場合、Lightning ノードは各新規チャネルに対してデフォルトの基本料金と料金レートを設定します。デフォルト値は、使用するノードの実装に依存します。
基本料金は<em>ミリサトシ</em>（1サトシの1000分の1）単位で設定されます。比例手数料率は、<em>百万分の</em>一の単位で設定され、支払額に適用されます。
百万分の一の単位は、しばしば<em>ppm</em>（parts per million）と略記される。
例えば、基本手数料が1,000（ミリサトシ）、手数料率が1,000ppm（百万分の一）の場合、10万サトシの支払いでは、以下のような手数料になります。</p>
</div>
<div class="stemblock">
<div class="content">
\♪♪～

P &amp;= 100,000\\
F_{base} &amp;= 1,000 \text{ millisatoshi} = 1 \text{ satoshi}\\
F_{rate} &amp;= 1,000 \text{ ppm} = 1,000/1,000,000 = 1/1,000 = \text{0.001} = 0.1% \.
F_{total} &amp;= F_{base} (総量)+ ( P * F_{rate} ) ୧୧⃛(๑⃙⃘◡̈๑⃙⃘)
 \Rightarrow F_{total} &amp;= 1 \text{ satoshi}+ ( 100,000/1,000 ) \text{ satoshi} ←クリック\\
 \Ȃ F_{total} &amp;= 1 Ȃtext{ satoshi｝+ 100 \text{ satoshi} = 101 \text{ satoshi}.\\
\Όταμμα
\Ίταμμα για για
</div>
</div>
<div class="paragraph">
<p>大きく分けて、ルーティングフィーには2つのアプローチがあります。低額の手数料で多くの支払いをルーティングし、低額の手数料を大量の手数料で補うことができます。もう1つは、高い手数料を設定する方法です。手数料を高く設定すると、他に安価なルートが存在しない場合にのみ、あなたのノードが選択されます。したがって、ルーティングの頻度は少なくなりますが、ルーティングが成功するごとに多くの利益を得ることができます。</p>
</div>
<div class="paragraph">
<p>ほとんどのノードでは、通常、デフォルトのルーティングフィー値を使用するのが最善です。この方法では、あなたのノードは、デフォルト値を使用する他のノードとほぼ同じ土俵で競争することになります。</p>
</div>
<div class="paragraph">
<p>また、ルーティングフィーの設定を利用して、チャンネルのリバランスを行うこともできます。ほとんどのチャンネルがデフォルトの手数料で、特定のチャンネルをリバランスしたい場合、その特定のチャンネルの手数料をゼロまたは非常に低いレートに下げるだけです。そして、誰かがあなたの「安い」ルートに支払いをルーティングし、副次的にあなたのためにチャンネルをリバランスしてくれるのを、じっと待っていましょう。</p>
</div>
</div>
<div class="sect2">
<h3 id="_node_management">ノード管理</h3>
<div class="paragraph">
<p>コマンドラインで Lightning ノードを管理することは、当然ながら簡単ではありません。ノードの API の完全な柔軟性と、個人的な要件を満たす独自のカスタムスクリプトを記述する能力を提供します。しかし、コマンドラインの複雑さに対処せず、いくつかの基本的なノード管理機能のみを必要とする場合、ノード管理を容易にするWebベースのユーザインタフェースのインストールを検討する必要があります。</p>
</div>
<div class="paragraph">
<p>ウェブベースのライトニング・ノード管理を提供する競合プロジェクトが数多く存在します。その中でも代表的なものを次のセクションで説明します。</p>
</div>
<div class="sect3">
<h4 id="rtl">ライド・ザ・ライトニング</h4>
<div class="paragraph">
<p>Ride The Lightning (RTL) は、3つの主要なLightningノード実装（LND、<code>c-lightning</code>、Eclair）のLightningノード操作を管理するためのグラフィカルなWebユーザーインターフェイスです。RTLは、Shahana Farooquiと他の多くの貢献者によって開発されたオープンソースプロジェクトです。RTLソフトウェアは、<a href="https://github.com/Ride-The-Lightning/RTL">GitHubで</a>見つけることができます。</p>
</div>
<div class="paragraph">
<p><a href="#rtl-web-interface">RTLのウェブインターフェースの例では</a>、プロジェクトリポジトリで提供されるRTLのウェブインターフェースのスクリーンショットの例を示しています。</p>
</div>
<div id="rtl-web-interface" class="imageblock">
<div class="content">
<img src="images/mtln_0505.png" alt="mtln 0505" />
</div>
<div class="title">図 5.RTL ウェブインタフェースの例</div>
</div>
</div>
<div class="sect3">
<h4 id="_lndmon">ランドモン</h4>
<div class="paragraph">
<p>LNDのメーカーであるLightning Labsは、LND Lightningノードの様々なメトリクスを監視するために、lndmonというWebベースのグラフィカルユーザインターフェイスを提供しています。これはモニタリングのための読み取り専用インタフェースであり、そのためノードを積極的に管理することはできません。チャンネルを開いたり、支払いを行ったりすることはできません。lndmonは<a href="https://github.com/lightninglabs/lndmon">GitHubで</a>見つかります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_thunderhub">サンダーハブ</h4>
<div class="paragraph">
<p><a href="https://thunderhub.io">ThunderHubは</a>RTLに似ているがLND専用の非常に美しいウェブベースのグラフィカルユーザーインターフェイスである。支払い、チャンネルのリバランス、様々な機能によるノードの管理に使用することができます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion">結論</h3>
<div class="paragraph">
<p>ノードを維持し、経験を積むことで、ライトニングネットワークについて多くのことを学ぶことができます。ノードオペレータは、やりがいのある仕事です。この技術を習得することで、この技術やライトニングネットワーク自体の成長・発展に貢献することができるようになります。さらに、ライトニング決済の送受信を自由自在にコントロールできるようになります。ネットワークのインフラで中心的な役割を果たし、端役にとどまらない。</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
最終更新 2022-10-29 15:50:16 +0400
</div>
</div>
</body>
</html>